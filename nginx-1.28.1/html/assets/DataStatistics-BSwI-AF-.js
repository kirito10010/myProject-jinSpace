import{d as Jt,S as xe,k as Gt,W as Xt,c as he,a as f,b as a,w as o,C as ue,D as Z,h as g,i as x,E as s,r as M,o as $,g as m,H as et,I as tt,z as pe,e as j,N as Ue,M as L,K as Pe,O as ze,P as H,L as Zt}from"./index-CuCVz4vD.js";import{s as R}from"./request-BYh0DQqL.js";import{i as ea,L as ta}from"./index-5QPu3XI4.js";import{_ as aa}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-B9ygI19o.js";const at=async y=>await R({url:"/api/project/list",method:"get",params:{uid:y}}),la=async y=>await R({url:"/api/project/add",method:"post",data:y}),oa=async(y,w)=>await R({url:"/api/project/update",method:"put",params:{uid:w},data:y}),ra=async(y,w)=>await R({url:`/api/project/${y}`,method:"delete",params:{uid:w}}),na=async(y,w)=>await R({url:"/api/project/batchDelete",method:"delete",data:{ids:y,uid:w}}),sa=async y=>await R({url:"/api/performance/add",method:"post",data:y}),ia=async(y,w)=>await R({url:"/api/performance/list",method:"get",params:{uid:y,date:w}}),da=async(y,w,U)=>await R({url:"/api/performance/range",method:"get",params:{uid:y,startDate:w,endDate:U}}),lt=async(y,w)=>await R({url:`/api/performance/${y}`,method:"delete",params:{uid:w}}),ua=async y=>R({url:"/api/salary/add",method:"post",data:y}),pa=async y=>R({url:"/api/salary/update",method:"put",data:y}),ca=async y=>R({url:"/api/salary/list",method:"get",params:{uid:y}}),ma=async(y,w)=>R({url:`/api/salary/${y}`,method:"delete",params:{uid:w}}),fa=async(y,w)=>R({url:"/api/salary/batch",method:"delete",data:{ids:y,uid:w}}),ga=async y=>await R({url:"/api/overtime/add",method:"post",data:y}),ya=async y=>await R({url:"/api/overtime/list",method:"get",params:{uid:y}}),va=async y=>await R({url:"/api/overtime/update",method:"put",data:y}),ba=async(y,w)=>await R({url:`/api/overtime/${y}`,method:"delete",params:{uid:w}}),wa=async(y,w)=>await R({url:"/api/overtime/batch",method:"delete",data:{ids:y,uid:w}}),ha={class:"data-statistics"},Da={class:"top-bar"},Va={class:"button-group"},Sa={class:"content-area"},ka={class:"time-range-selector"},Ca={key:0,class:"month-select-range"},Ra={key:1,class:"custom-date-range"},ja={class:"performance-summary"},Ma={class:"performance-card"},xa={class:"performance-value"},Ua={class:"performance-card"},Pa={class:"performance-value"},za={class:"performance-card"},Ea={class:"performance-value"},Aa={class:"chart-container"},Ya={class:"table-actions"},qa={class:"pagination"},$a={class:"dialog-footer"},Ba={class:"table-actions"},_a={class:"pagination"},Fa={class:"dialog-footer"},Ia={class:"table-actions"},Oa={class:"pagination"},Na={class:"form-row"},Wa={class:"form-col"},Ta={class:"form-col"},La={class:"dialog-footer"},Ha={class:"form-row"},Qa={class:"form-col"},Ka={class:"form-col"},Ja={class:"dialog-footer"},Ga={class:"table-actions"},Xa={class:"pagination"},Za={class:"dialog-footer"},el=Jt({__name:"DataStatistics",setup(y){const w=g(!1),U=g(!1),ce=g(!1),ee=g(!1),De=g(!1),me=g(!1),Ve=g(!1),te=g(!1),ae=g(!1),le=g([]),I=g([]),Ie=g([]),Ee=g(!1),P=x({current:1,pageSize:10,total:0}),Q=g(),h=x({id:0,reportDate:"",overtimeHours:0,projectName:"",description:""}),ot=x({reportDate:[{required:!0,message:"请选择汇报日期",trigger:"change"}],overtimeHours:[{required:!0,message:"请输入加班小时数",trigger:"blur"},{type:"number",min:.5,message:"加班小时数必须大于等于0.5",trigger:"blur"}]}),v=x({attendanceDays:25,baseSalary:2e3,performance:0,positionPerformance:500,mealAllowance:200,housingAllowance:300,fullAttendance:300,otherBonus:100,pension:360.32,medical:90.08,unemployment:13.51}),rt=()=>{try{const t=C();if(!t)return;const e=localStorage.getItem(`salary_default_config_${t.id}`);if(e){const r=JSON.parse(e);Object.assign(v,r)}}catch(t){console.error("加载默认配置失败：",t)}},nt=()=>{try{const t=C();if(!t){s.error("请先登录");return}localStorage.setItem(`salary_default_config_${t.id}`,JSON.stringify(v)),s.success("默认配置保存成功"),me.value=!1}catch(t){console.error("保存默认配置失败：",t),s.error("保存默认配置失败")}},oe=g(!1),Ae=g(!1),re=g(!1),Se=g(!1),Ye=g(!1),qe=g(!1),fe=g([]),ne=g([]),K=g([]),Oe=g([]),z=x({current:1,pageSize:10,total:0}),O=g([]),N=g([]),Ne=g([]),$e=g(!1),E=x({current:1,pageSize:10,total:0}),J=g(),n=x({id:0,uid:"",yearMonth:"",periodStart:"",periodEnd:"",attendanceDays:0,baseSalary:0,performance:0,performanceSalary:0,positionPerformance:0,mealAllowance:0,housingAllowance:0,fullAttendance:0,otherBonus:0,pension:0,medical:0,unemployment:0,lateDeduction:0,overtimeHours:0,overtimeSalary:0,totalIncome:0,totalDeduction:0,netSalary:0}),st=x({yearMonth:[{required:!0,message:"请选择年月",trigger:"change"}],periodStart:[{required:!0,message:"请选择周期开始日期",trigger:"change"}],periodEnd:[{required:!0,message:"请选择周期结束日期",trigger:"change"}],attendanceDays:[{required:!0,message:"请输入出勤天数",trigger:"blur"},{type:"number",min:0,message:"出勤天数必须大于等于0",trigger:"blur"}],baseSalary:[{required:!0,message:"请输入基本薪资",trigger:"blur"},{type:"number",min:0,message:"基本薪资必须大于等于0",trigger:"blur"}],performance:[{required:!0,message:"请输入绩效系数/评分",trigger:"blur"},{type:"number",min:0,message:"绩效系数必须大于等于0",trigger:"blur"}],performanceSalary:[{required:!0,message:"请输入绩效薪资",trigger:"blur"},{type:"number",min:0,message:"绩效薪资必须大于等于0",trigger:"blur"}],positionPerformance:[{required:!0,message:"请输入岗位绩效",trigger:"blur"},{type:"number",min:0,message:"岗位绩效必须大于等于0",trigger:"blur"}],mealAllowance:[{required:!0,message:"请输入餐补",trigger:"blur"},{type:"number",min:0,message:"餐补必须大于等于0",trigger:"blur"}],housingAllowance:[{required:!0,message:"请输入房补",trigger:"blur"},{type:"number",min:0,message:"房补必须大于等于0",trigger:"blur"}],fullAttendance:[{required:!0,message:"请输入全勤奖",trigger:"blur"},{type:"number",min:0,message:"全勤奖必须大于等于0",trigger:"blur"}],otherBonus:[{required:!0,message:"请输入其他奖金",trigger:"blur"},{type:"number",min:0,message:"其他奖金必须大于等于0",trigger:"blur"}],pension:[{required:!0,message:"请输入养老保险",trigger:"blur"},{type:"number",min:0,message:"养老保险必须大于等于0",trigger:"blur"}],medical:[{required:!0,message:"请输入医疗保险",trigger:"blur"},{type:"number",min:0,message:"医疗保险必须大于等于0",trigger:"blur"}],unemployment:[{required:!0,message:"请输入失业保险",trigger:"blur"},{type:"number",min:0,message:"失业保险必须大于等于0",trigger:"blur"}],lateDeduction:[{type:"number",min:0,message:"迟到分钟必须大于等于0",trigger:"blur"}],overtimeHours:[{type:"number",min:0,message:"加班时长必须大于等于0",trigger:"blur"}],overtimeSalary:[{type:"number",min:0,message:"加班薪资必须大于等于0",trigger:"blur"}],totalIncome:[{required:!0,message:"请输入应发总额",trigger:"blur"},{type:"number",min:0,message:"应发总额必须大于等于0",trigger:"blur"}],totalDeduction:[{required:!0,message:"请输入扣除总额",trigger:"blur"},{type:"number",min:0,message:"扣除总额必须大于等于0",trigger:"blur"}],netSalary:[{required:!0,message:"请输入实发薪资",trigger:"blur"},{type:"number",min:0,message:"实发薪资必须大于等于0",trigger:"blur"}]}),B=g("month"),W=g([]),ge=g(""),We=g([]),se=x({totalPerformance:"0.00000",attendanceDays:0,avgPerformance:"0.00000"}),Be=g();let ye=null;const Te=g(!1),G=g(),u=x({id:0,date:"",project:null,process:"",quotaEfficiency:0,actualWorkload:0,performanceManDays:"0.00000"}),it=x({date:[{required:!0,message:"请选择绩效日期",trigger:"change"}],project:[{required:!0,message:"请选择生产项目",trigger:"change"}],process:[{required:!0,message:"请选择工序",trigger:"change"}],actualWorkload:[{required:!0,message:"请输入实际工作量",trigger:"blur"},{type:"number",min:1,message:"实际工作量必须大于0",trigger:"blur"}]}),_=g([]),T=g([]),Le=g([]),A=x({current:1,pageSize:10,total:0}),D=x({id:0,projectCode:"",projectName:"",uid:0,workQuotaEfficiency:0,inspectQuotaEfficiency:0,status:1}),_e=g(),dt=x({projectCode:[{required:!0,message:"请输入项目编码",trigger:"blur"},{min:1,max:50,message:"项目编码长度不能超过50个字符",trigger:"blur"}],projectName:[{required:!0,message:"请输入项目名称",trigger:"blur"},{min:1,max:100,message:"项目名称长度不能超过100个字符",trigger:"blur"}],workQuotaEfficiency:[{required:!1,message:"请输入作业工序额定效率",trigger:"blur"},{type:"number",min:0,message:"作业工序额定效率必须大于等于0",trigger:"blur"}],inspectQuotaEfficiency:[{required:!1,message:"请输入质检工序额定效率",trigger:"blur"},{type:"number",min:0,message:"质检工序额定效率必须大于等于0",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]}),C=()=>{const t=localStorage.getItem("userInfo");return t?JSON.parse(t):null},ke=async()=>{try{Ye.value=!0;const t=C();if(!t){s.error("请先登录");return}const e=await at(t.id);if(e.code===200&&e.success){const r=e.data;A.total=r.length;const i=(A.current-1)*A.pageSize,c=i+A.pageSize;_.value=r.slice(i,c)}else s.error("获取项目列表失败："+e.message)}catch(t){console.error("获取项目列表失败：",t),s.error("获取项目列表失败")}finally{Ye.value=!1}},ut=t=>{Le.value=t,T.value=t.map(e=>e.id)},pt=()=>{D.id=0,D.projectCode="",D.projectName="",D.status=1,D.workQuotaEfficiency=0,D.inspectQuotaEfficiency=0;const t=C();t&&(D.uid=t.id),Se.value=!1,re.value=!0},ct=t=>{D.id=t.id,D.projectCode=t.projectCode,D.projectName=t.projectName,D.status=t.status,D.workQuotaEfficiency=t.workQuotaEfficiency||0,D.inspectQuotaEfficiency=t.inspectQuotaEfficiency||0,Se.value=!0,re.value=!0},mt=async()=>{if(_e.value)try{await _e.value.validate();const t=C();if(!t){s.error("请先登录");return}if(Se.value){const e=await oa(D,t.id);if(e.code===200&&e.success){const r=_.value.findIndex(i=>i.id===D.id);if(r!==-1){const i=_.value[r];i&&(_.value[r]={...D,uid:i.uid,createdAt:i.createdAt,updatedAt:new Date().toISOString()})}s.success("项目修改成功")}else{let r=e.message;r.includes("Duplicate entry")&&r.includes("project_code")&&(r="项目编码已存在，请使用其他编码"),s.error("项目修改失败："+r)}}else{D.uid=t.id;const e=await la(D);if(e.code===200&&e.success)await ke(),s.success("项目添加成功");else{let r=e.message;r.includes("Duplicate entry")&&r.includes("project_code")&&(r="项目编码已存在，请使用其他编码"),s.error("项目添加失败："+r)}}re.value=!1}catch(t){console.error("保存项目失败：",t),s.error("保存项目失败")}},ft=t=>{H.confirm("确定要删除这个项目吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const e=C();if(!e){s.error("请先登录");return}const r=await ra(t,e.id);r.code===200&&r.success?(_.value=_.value.filter(i=>i.id!==t),A.total--,s.success("项目删除成功")):s.error("项目删除失败："+r.message)}catch(e){console.error("删除项目失败：",e),s.error("删除项目失败")}}).catch(()=>{})},gt=()=>{if(T.value.length===0){s.warning("请选择要删除的项目");return}H.confirm(`确定要删除选中的 ${T.value.length} 个项目吗？`,"批量删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const t=C();if(!t){s.error("请先登录");return}const e=await na(T.value,t.id);e.code===200&&e.success?(_.value=_.value.filter(r=>!T.value.includes(r.id)),A.total-=T.value.length,T.value=[],Le.value=[],s.success("批量删除成功")):s.error("批量删除失败："+e.message)}catch(t){console.error("批量删除项目失败：",t),s.error("批量删除项目失败")}}).catch(()=>{})},yt=t=>{A.pageSize=t,ke()},vt=t=>{A.current=t,ke()};xe(()=>w.value,t=>{t&&ke()});const He=async()=>{try{const t=C();if(!t){s.error("请先登录");return}const e=await at(t.id);e.code===200&&e.success?fe.value=e.data:s.error("获取生产项目列表失败："+e.message)}catch(t){console.error("获取生产项目列表失败：",t),s.error("获取生产项目列表失败")}},bt=()=>{Qe()},Qe=()=>{if(u.project&&u.process){const t=fe.value.find(e=>e.id===u.project);t&&(u.process==="作业"?u.quotaEfficiency=t.workQuotaEfficiency||0:u.process==="质检"&&(u.quotaEfficiency=t.inspectQuotaEfficiency||0),Ke())}},Ke=()=>{if(u.quotaEfficiency>0&&u.actualWorkload>0){const t=u.actualWorkload/u.quotaEfficiency;u.performanceManDays=t.toFixed(5)}else u.performanceManDays="0.00000"},wt=async()=>{if(G.value)try{await G.value.validate();const t=C();if(!t){s.error("请先登录");return}const e=fe.value.find(c=>c.id===u.project);if(!e){s.error("请选择有效的生产项目");return}const r={uid:t.id,date:u.date,project:e.projectName,process:u.process,quotaEfficiency:u.quotaEfficiency,actualWorkload:u.actualWorkload,performanceManDays:parseFloat(u.performanceManDays)},i=await sa(r);if(i.code===200&&i.success)s.success("工作汇报保存成功"),oe.value=!1,await Ce(),u.id=0,u.date="",u.project=null,u.process="",u.quotaEfficiency=0,u.actualWorkload=0,u.performanceManDays="0.00000";else{let c=i.message;(c.includes("Duplicate entry")||c.includes("重复"))&&(c="该绩效记录已存在，请检查日期和项目"),s.error("工作汇报保存失败："+c)}}catch(t){console.error("保存工作汇报失败：",t),s.error("保存工作汇报失败")}},Ce=async()=>{try{qe.value=!0;const t=C();if(!t){s.error("请先登录");return}const e=await ia(t.id);if(e.code===200&&e.success){const r=e.data;z.total=r.length;const i=(z.current-1)*z.pageSize,c=i+z.pageSize;ne.value=r.slice(i,c)}else s.error("获取绩效记录列表失败："+e.message)}catch(t){console.error("获取绩效记录列表失败：",t),s.error("获取绩效记录列表失败")}finally{qe.value=!1}},ht=t=>{Oe.value=t,K.value=t.map(e=>e.id)},Dt=()=>{u.id=0,u.date="",u.project=null,u.process="",u.quotaEfficiency=0,u.actualWorkload=0,u.performanceManDays="0.00000",G.value&&G.value.resetFields(),Ae.value=!1,oe.value=!0},Vt=async t=>{G.value&&G.value.resetFields(),Ae.value=!0,oe.value=!0,await He(),u.id=t.id,u.date=t.date;const e=fe.value.find(r=>r.projectName===t.project);u.project=e?e.id:null,u.process=t.process,u.quotaEfficiency=t.quotaEfficiency,u.actualWorkload=t.actualWorkload,u.performanceManDays=t.performanceManDays.toString()},St=t=>{H.confirm("确定要删除这条绩效记录吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const e=C();if(!e){s.error("请先登录");return}const r=await lt(t,e.id);r.code===200&&r.success?(ne.value=ne.value.filter(i=>i.id!==t),z.total--,s.success("绩效记录删除成功")):s.error("绩效记录删除失败："+r.message)}catch(e){console.error("删除绩效记录失败：",e),s.error("删除绩效记录失败")}}).catch(()=>{})},kt=()=>{if(K.value.length===0){s.warning("请选择要删除的绩效记录");return}H.confirm(`确定要删除选中的 ${K.value.length} 条绩效记录吗？`,"批量删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const t=C();if(!t){s.error("请先登录");return}let e=0;for(const r of K.value){const i=await lt(r,t.id);i.code===200&&i.success&&e++}ne.value=ne.value.filter(r=>!K.value.includes(r.id)),z.total-=e,K.value=[],Oe.value=[],s.success(`批量删除成功，共删除 ${e} 条绩效记录`)}catch(t){console.error("批量删除绩效记录失败：",t),s.error("批量删除绩效记录失败")}}).catch(()=>{})},Ct=t=>{z.pageSize=t,Ce()},Rt=t=>{z.current=t,Ce()},Re=async()=>{try{$e.value=!0;const t=C();if(!t){s.error("请先登录");return}const e=await ca(t.id);if(e.code===200&&e.success){const r=e.data;E.total=r.length;const i=(E.current-1)*E.pageSize,c=i+E.pageSize;O.value=r.slice(i,c)}else s.error("获取工资记录列表失败："+e.message)}catch(t){console.error("获取工资记录列表失败：",t),s.error("获取工资记录列表失败")}finally{$e.value=!1}},jt=t=>{Ne.value=t,N.value=t.map(e=>e.id)},Je=()=>{n.performanceSalary=170*.94*n.performance},Ge=()=>{n.overtimeSalary=n.overtimeHours*17},ve=()=>{const t=n.attendanceDays*8*60,e=t-n.lateDeduction,r=t>0?e/t:0,i=n.baseSalary*r,c=n.positionPerformance*r,V=n.mealAllowance*r,S=n.housingAllowance*r;n.totalIncome=i+n.performanceSalary+c+V+S+n.fullAttendance+n.otherBonus+n.overtimeSalary,n.totalDeduction=n.pension+n.medical+n.unemployment,n.netSalary=n.totalIncome-n.totalDeduction},Mt=()=>{if(!n.yearMonth)return;const[t,e]=n.yearMonth.split("-");if(!t||!e)return;const r=parseInt(t),i=parseInt(e);let c=r,V=i-1;V===0&&(c--,V=12);const S=`${c}-${String(V).padStart(2,"0")}-26`,k=`${r}-${e}-25`;n.periodStart=S,n.periodEnd=k,Je(),Ge(),ve()},xt=()=>{n.id=0,n.uid="",n.yearMonth="",n.periodStart="",n.periodEnd="",n.attendanceDays=v.attendanceDays,n.baseSalary=v.baseSalary,n.performance=v.performance,n.performanceSalary=0,n.positionPerformance=v.positionPerformance,n.mealAllowance=v.mealAllowance,n.housingAllowance=v.housingAllowance,n.fullAttendance=v.fullAttendance,n.otherBonus=v.otherBonus,n.pension=v.pension,n.medical=v.medical,n.unemployment=v.unemployment,n.lateDeduction=0,n.overtimeHours=0,n.overtimeSalary=0,n.totalIncome=0,n.totalDeduction=0,n.netSalary=0,J.value&&J.value.resetFields(),De.value=!1,ee.value=!0},Ut=t=>{J.value&&J.value.resetFields(),n.id=t.id,n.uid=t.uid,n.yearMonth=t.yearMonth,n.periodStart=t.periodStart,n.periodEnd=t.periodEnd,n.attendanceDays=t.attendanceDays,n.baseSalary=t.baseSalary,n.performance=t.performance,n.performanceSalary=t.performanceSalary,n.positionPerformance=t.positionPerformance,n.mealAllowance=t.mealAllowance,n.housingAllowance=t.housingAllowance,n.fullAttendance=t.fullAttendance,n.otherBonus=t.otherBonus,n.pension=t.pension,n.medical=t.medical,n.unemployment=t.unemployment,n.lateDeduction=t.lateDeduction,n.overtimeHours=t.overtimeHours,n.overtimeSalary=t.overtimeSalary,n.totalIncome=t.totalIncome,n.totalDeduction=t.totalDeduction,n.netSalary=t.netSalary,De.value=!0,ee.value=!0},Pt=async()=>{if(J.value)try{await J.value.validate();const t=C();if(!t){s.error("请先登录");return}if(n.uid=t.id,De.value){const e=await pa(n);if(e.code===200&&e.success){const r=O.value.findIndex(i=>i.id===n.id);r!==-1&&(O.value[r]={...n}),s.success("工资记录修改成功")}else s.error("工资记录修改失败："+e.message)}else{const e=await ua(n);if(e.code===200&&e.success)await Re(),s.success("工资记录添加成功");else{let r=e.message;r.includes("Duplicate entry")&&r.includes("idx_uid_month")&&(r="该月份的工资记录已存在，请修改或删除原记录后重新添加"),s.error("工资记录添加失败："+r)}}ee.value=!1}catch(t){console.error("保存工资记录失败：",t),s.error("保存工资记录失败")}},zt=t=>{H.confirm("确定要删除这条工资记录吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const e=C();if(!e){s.error("请先登录");return}const r=await ma(t,e.id);r.code===200&&r.success?(O.value=O.value.filter(i=>i.id!==t),E.total--,s.success("工资记录删除成功")):s.error("工资记录删除失败："+r.message)}catch(e){console.error("删除工资记录失败：",e),s.error("删除工资记录失败")}}).catch(()=>{})},Et=()=>{if(N.value.length===0){s.warning("请选择要删除的工资记录");return}H.confirm(`确定要删除选中的 ${N.value.length} 条工资记录吗？`,"批量删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const t=C();if(!t){s.error("请先登录");return}const e=await fa(N.value,t.id);e.code===200&&e.success?(O.value=O.value.filter(r=>!N.value.includes(r.id)),E.total-=N.value.length,N.value=[],Ne.value=[],s.success("批量删除成功")):s.error("批量删除失败："+e.message)}catch(t){console.error("批量删除工资记录失败：",t),s.error("批量删除工资记录失败")}}).catch(()=>{})},At=t=>{E.pageSize=t,Re()},Yt=t=>{E.current=t,Re()};xe(()=>U.value,t=>{t&&(He(),Ce())}),xe(()=>ce.value,t=>{t&&Re()}),xe(()=>Ve.value,t=>{t&&je()});const je=async()=>{try{Ee.value=!0;const t=C();if(!t){s.error("请先登录");return}const e=await ya(t.id);if(e.code===200&&e.success){const r=e.data;P.total=r.length;const i=(P.current-1)*P.pageSize,c=i+P.pageSize;le.value=r.slice(i,c)}else s.error("获取加班记录列表失败："+e.message)}catch(t){console.error("获取加班记录列表失败：",t),s.error("获取加班记录列表失败")}finally{Ee.value=!1}},qt=t=>{Ie.value=t,I.value=t.map(e=>e.id)},$t=()=>{h.id=0,h.reportDate="",h.overtimeHours=0,h.projectName="",h.description="",Q.value&&Q.value.resetFields(),ae.value=!1,te.value=!0},Bt=t=>{Q.value&&Q.value.resetFields(),h.id=t.id,h.reportDate=t.reportDate,h.overtimeHours=t.overtimeHours,h.projectName=t.projectName||"",h.description=t.description||"",ae.value=!0,te.value=!0},_t=async()=>{if(Q.value)try{await Q.value.validate();const t=C();if(!t){s.error("请先登录");return}const e={uid:t.id,reportDate:h.reportDate,overtimeHours:h.overtimeHours,projectName:h.projectName,description:h.description};let r;if(ae.value?r=await va({...e,id:h.id}):r=await ga(e),r.code===200&&r.success)s.success(ae.value?"加班记录修改成功":"加班记录添加成功"),te.value=!1,await je(),h.id=0,h.reportDate="",h.overtimeHours=0,h.projectName="",h.description="";else{let i=r.message;i.includes("Duplicate entry")&&i.includes("unique_report")&&(i="该日期的加班记录已存在，请修改或删除原记录后重新添加"),s.error((ae.value?"加班记录修改失败：":"加班记录添加失败：")+i)}}catch(t){console.error("保存加班记录失败：",t),s.error("保存加班记录失败")}},Ft=t=>{H.confirm("确定要删除这条加班记录吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const e=C();if(!e){s.error("请先登录");return}const r=await ba(t,e.id);r.code===200&&r.success?(le.value=le.value.filter(i=>i.id!==t),P.total--,s.success("加班记录删除成功")):s.error("加班记录删除失败："+r.message)}catch(e){console.error("删除加班记录失败：",e),s.error("删除加班记录失败")}}).catch(()=>{})},It=()=>{if(I.value.length===0){s.warning("请选择要删除的加班记录");return}H.confirm(`确定要删除选中的 ${I.value.length} 条加班记录吗？`,"批量删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const t=C();if(!t){s.error("请先登录");return}const e=await wa(I.value,t.id);e.code===200&&e.success?(le.value=le.value.filter(r=>!I.value.includes(r.id)),P.total-=I.value.length,I.value=[],Ie.value=[],s.success("批量删除成功")):s.error("批量删除失败："+e.message)}catch(t){console.error("批量删除加班记录失败：",t),s.error("批量删除加班记录失败")}}).catch(()=>{})},Ot=t=>{P.pageSize=t,je()},Nt=t=>{P.current=t,je()},Fe=()=>{const t=new Date,e=t.getFullYear(),r=t.getMonth();let i,c;t.getDate()>=26?(i=new Date(e,r,26),c=new Date(e,r+1,25)):(i=new Date(e,r-1,26),c=new Date(e,r,25));const V=S=>{const k=S.getFullYear(),d=String(S.getMonth()+1).padStart(2,"0"),Y=String(S.getDate()).padStart(2,"0");return`${k}-${d}-${Y}`};return{startDate:V(i),endDate:V(c)}},Wt=()=>{const t=new Date,e=t.getDay()||7,r=new Date(t);r.setDate(t.getDate()-e+1);const i=new Date(r);i.setDate(r.getDate()+6);const c=V=>{const S=V.getFullYear(),k=String(V.getMonth()+1).padStart(2,"0"),d=String(V.getDate()).padStart(2,"0");return`${S}-${k}-${d}`};return{startDate:c(r),endDate:c(i)}},ie=async(t,e)=>{try{Te.value=!0;const r=C();if(!r){s.error("请先登录");return}const i=await da(r.id,t,e);if(i.code===200&&i.success){const c=i.data,V=c.reduce((q,de)=>q+parseFloat(de.performanceManDays.toString()),0),k=new Set(c.map(q=>q.date)).size,d=V-k,Y=k>0?d/k:0;se.totalPerformance=d.toFixed(5),se.attendanceDays=k,se.avgPerformance=Y.toFixed(5),Lt(c,t,e)}else s.error("获取绩效数据失败："+i.message)}catch(r){console.error("获取绩效数据失败：",r),s.error("获取绩效数据失败")}finally{Te.value=!1}},Tt=()=>{if(Be.value){ye=ea(Be.value);const t={tooltip:{trigger:"axis",formatter:function(e){return e[0].name+"<br/>绩效人天："+e[0].value.toFixed(5)}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value",axisLabel:{formatter:"{value}"}},series:[{name:"绩效人天",type:"line",smooth:!0,data:[],itemStyle:{color:"#667eea"},areaStyle:{color:new ta(0,0,0,1,[{offset:0,color:"rgba(102, 126, 234, 0.5)"},{offset:1,color:"rgba(102, 126, 234, 0.1)"}])}}]};ye.setOption(t),window.addEventListener("resize",()=>{ye?.resize()})}},Lt=(t,e,r)=>{if(!ye)return;const i=[],c=new Date(e),V=new Date(r);for(let d=new Date(c);d<=V;d.setDate(d.getDate()+1))i.push(d.toISOString().split("T")[0]);const S=new Map;t.forEach(d=>{const Y=d.date,q=parseFloat(d.performanceManDays.toString());S.has(Y)?S.set(Y,S.get(Y)+q):S.set(Y,q)});const k=i.map(d=>S.get(d)||0);ye.setOption({xAxis:{data:i},yAxis:{type:"value",axisLabel:{formatter:"{value}"},axisLine:{show:!0},splitLine:{show:!0}},series:[{data:k,markLine:{silent:!0,data:[{yAxis:1,label:{formatter:"定额",position:"end"},lineStyle:{color:"#ff4d4f",width:1,type:"dashed"}}]}}]})},Ht=()=>{if(B.value==="week"){const t=Wt();ie(t.startDate,t.endDate)}else if(B.value==="month"){const t=Fe();ie(t.startDate,t.endDate)}else if(B.value==="month_select"){Qt();const e=Fe().startDate.substring(0,7);ge.value=e,Xe()}else B.value==="custom"&&W.value.length===2&&ie(W.value[0],W.value[1])},Qt=()=>{const t=[],e=new Date;for(let r=11;r>=0;r--){const i=new Date(e.getFullYear(),e.getMonth()-r,1),c=i.getFullYear(),V=i.getMonth()+1,S=`${c}-${V.toString().padStart(2,"0")}`,k=`${c}年${V}月`;t.push({value:S,label:k})}We.value=t},Xe=()=>{if(!ge.value)return;const[t,e]=ge.value.split("-"),r=Number(t)||0,i=Number(e)||1;let c,V;c=new Date(r,i-1,26),V=new Date(r,i,25);const S=k=>{const d=k.getFullYear(),Y=String(k.getMonth()+1).padStart(2,"0"),q=String(k.getDate()).padStart(2,"0");return`${d}-${Y}-${q}`};ie(S(c),S(V))},Kt=()=>{B.value==="custom"&&W.value.length===2&&ie(W.value[0],W.value[1])},Ze=t=>{if(!t)return"";const e=new Date(t),r=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),c=String(e.getDate()).padStart(2,"0");return`${r}-${i}-${c}`};return Gt(()=>{rt(),Xt(()=>{Tt();const t=Fe();ie(t.startDate,t.endDate)})}),(t,e)=>{const r=M("el-button"),i=M("el-radio"),c=M("el-radio-group"),V=M("el-option"),S=M("el-select"),k=M("el-date-picker"),d=M("el-table-column"),Y=M("el-tag"),q=M("el-table"),de=M("el-pagination"),be=M("el-input"),p=M("el-form-item"),b=M("el-input-number"),we=M("el-form"),F=M("el-dialog"),Me=Zt("loading");return $(),he("div",ha,[f("div",Da,[e[83]||(e[83]=f("h2",null,"绩效记录",-1)),f("div",Va,[a(r,{type:"primary",onClick:e[0]||(e[0]=l=>U.value=!0)},{default:o(()=>[...e[79]||(e[79]=[m(" 工作汇报 ",-1)])]),_:1}),a(r,{type:"primary",onClick:e[1]||(e[1]=l=>Ve.value=!0)},{default:o(()=>[...e[80]||(e[80]=[m(" 加班汇报 ",-1)])]),_:1}),a(r,{type:"primary",onClick:e[2]||(e[2]=l=>ce.value=!0)},{default:o(()=>[...e[81]||(e[81]=[m(" 工资记录 ",-1)])]),_:1}),a(r,{type:"primary",onClick:e[3]||(e[3]=l=>w.value=!0)},{default:o(()=>[...e[82]||(e[82]=[m(" 生产项目配置 ",-1)])]),_:1})])]),f("div",Sa,[f("div",ka,[a(c,{modelValue:B.value,"onUpdate:modelValue":e[4]||(e[4]=l=>B.value=l),onChange:Ht},{default:o(()=>[a(i,{label:"week"},{default:o(()=>[...e[84]||(e[84]=[m("本周",-1)])]),_:1}),a(i,{label:"month"},{default:o(()=>[...e[85]||(e[85]=[m("本月",-1)])]),_:1}),a(i,{label:"month_select"},{default:o(()=>[...e[86]||(e[86]=[m("选择月份",-1)])]),_:1}),a(i,{label:"custom"},{default:o(()=>[...e[87]||(e[87]=[m("自定义",-1)])]),_:1})]),_:1},8,["modelValue"]),B.value==="month_select"?($(),he("div",Ca,[a(S,{modelValue:ge.value,"onUpdate:modelValue":e[5]||(e[5]=l=>ge.value=l),placeholder:"请选择月份",style:{width:"200px"},onChange:Xe},{default:o(()=>[($(!0),he(et,null,tt(We.value,l=>($(),pe(V,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])):ue("",!0),B.value==="custom"?($(),he("div",Ra,[a(k,{modelValue:W.value,"onUpdate:modelValue":e[6]||(e[6]=l=>W.value=l),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:Kt},null,8,["modelValue"])])):ue("",!0)]),f("div",ja,[f("div",Ma,[e[88]||(e[88]=f("div",{class:"performance-label"},"当月绩效总和",-1)),f("div",xa,Z(se.totalPerformance),1),e[89]||(e[89]=f("div",{class:"performance-desc"},"绩效人天合计",-1))]),f("div",Ua,[e[90]||(e[90]=f("div",{class:"performance-label"},"当月考勤天数",-1)),f("div",Pa,Z(se.attendanceDays),1),e[91]||(e[91]=f("div",{class:"performance-desc"},"当月出勤天数",-1))]),f("div",za,[e[92]||(e[92]=f("div",{class:"performance-label"},"日均绩效",-1)),f("div",Ea,Z(se.avgPerformance),1),e[93]||(e[93]=f("div",{class:"performance-desc"},"平均绩效人天",-1))])]),f("div",Aa,[e[94]||(e[94]=f("h3",null,"绩效趋势",-1)),f("div",{id:"performanceChart",ref_key:"performanceChartRef",ref:Be,class:"chart"},null,512)])]),a(F,{modelValue:w.value,"onUpdate:modelValue":e[16]||(e[16]=l=>w.value=l),title:"生产项目配置",width:"90%","max-width":"1200px"},{default:o(()=>[f("div",Ya,[a(r,{type:"primary",onClick:pt},{icon:o(()=>[a(j(Ue))]),default:o(()=>[e[95]||(e[95]=m(" 添加项目 ",-1))]),_:1}),a(r,{type:"danger",disabled:T.value.length===0,onClick:gt},{icon:o(()=>[a(j(L))]),default:o(()=>[e[96]||(e[96]=m(" 批量删除 ",-1))]),_:1},8,["disabled"])]),Pe(($(),pe(q,{data:_.value,style:{width:"100%"},onSelectionChange:ut},{default:o(()=>[a(d,{type:"selection","min-width":"55"}),ue("",!0),a(d,{prop:"projectCode",label:"项目编码","min-width":"120"}),a(d,{prop:"projectName",label:"项目名称","min-width":"150"}),a(d,{prop:"workQuotaEfficiency",label:"作业工序额定效率","min-width":"140"}),a(d,{prop:"inspectQuotaEfficiency",label:"质检工序额定效率","min-width":"140"}),a(d,{prop:"status",label:"状态","min-width":"80"},{default:o(l=>[a(Y,{type:l.row.status===1?"success":"danger"},{default:o(()=>[m(Z(l.row.status===1?"启用":"停用"),1)]),_:2},1032,["type"])]),_:1}),a(d,{label:"操作","min-width":"180"},{default:o(l=>[a(r,{type:"primary",size:"small",onClick:X=>ct(l.row)},{icon:o(()=>[a(j(ze))]),default:o(()=>[e[97]||(e[97]=m(" 修改 ",-1))]),_:1},8,["onClick"]),a(r,{type:"danger",size:"small",onClick:X=>ft(l.row.id)},{icon:o(()=>[a(j(L))]),default:o(()=>[e[98]||(e[98]=m(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Me,Ye.value]]),f("div",qa,[a(de,{"current-page":A.current,"onUpdate:currentPage":e[7]||(e[7]=l=>A.current=l),"page-size":A.pageSize,"onUpdate:pageSize":e[8]||(e[8]=l=>A.pageSize=l),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:A.total,onSizeChange:yt,onCurrentChange:vt},null,8,["current-page","page-size","total"])]),a(F,{modelValue:re.value,"onUpdate:modelValue":e[15]||(e[15]=l=>re.value=l),title:Se.value?"修改项目":"添加项目",width:"500px"},{footer:o(()=>[f("span",$a,[a(r,{onClick:e[14]||(e[14]=l=>re.value=!1)},{default:o(()=>[...e[101]||(e[101]=[m("取消",-1)])]),_:1}),a(r,{type:"primary",onClick:mt},{default:o(()=>[...e[102]||(e[102]=[m("确定",-1)])]),_:1})])]),default:o(()=>[a(we,{ref_key:"projectFormRef",ref:_e,model:D,rules:dt,"label-width":"150px"},{default:o(()=>[a(p,{label:"项目编码",prop:"projectCode"},{default:o(()=>[a(be,{modelValue:D.projectCode,"onUpdate:modelValue":e[9]||(e[9]=l=>D.projectCode=l),placeholder:"请输入项目编码"},null,8,["modelValue"])]),_:1}),a(p,{label:"项目名称",prop:"projectName"},{default:o(()=>[a(be,{modelValue:D.projectName,"onUpdate:modelValue":e[10]||(e[10]=l=>D.projectName=l),placeholder:"请输入项目名称"},null,8,["modelValue"])]),_:1}),a(p,{label:"作业工序额定效率",prop:"workQuotaEfficiency"},{default:o(()=>[a(b,{modelValue:D.workQuotaEfficiency,"onUpdate:modelValue":e[11]||(e[11]=l=>D.workQuotaEfficiency=l),min:0,placeholder:"请输入作业工序额定效率"},null,8,["modelValue"])]),_:1}),a(p,{label:"质检工序额定效率",prop:"inspectQuotaEfficiency"},{default:o(()=>[a(b,{modelValue:D.inspectQuotaEfficiency,"onUpdate:modelValue":e[12]||(e[12]=l=>D.inspectQuotaEfficiency=l),min:0,placeholder:"请输入质检工序额定效率"},null,8,["modelValue"])]),_:1}),a(p,{label:"状态",prop:"status"},{default:o(()=>[a(c,{modelValue:D.status,"onUpdate:modelValue":e[13]||(e[13]=l=>D.status=l)},{default:o(()=>[a(i,{label:1},{default:o(()=>[...e[99]||(e[99]=[m("启用",-1)])]),_:1}),a(i,{label:0},{default:o(()=>[...e[100]||(e[100]=[m("停用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])]),_:1},8,["modelValue"]),a(F,{modelValue:U.value,"onUpdate:modelValue":e[27]||(e[27]=l=>U.value=l),title:"工作汇报",width:"90%","max-width":"1000px"},{default:o(()=>[f("div",Ba,[a(r,{type:"primary",onClick:Dt},{icon:o(()=>[a(j(Ue))]),default:o(()=>[e[103]||(e[103]=m(" 添加绩效记录 ",-1))]),_:1}),a(r,{type:"danger",disabled:K.value.length===0,onClick:kt},{icon:o(()=>[a(j(L))]),default:o(()=>[e[104]||(e[104]=m(" 批量删除 ",-1))]),_:1},8,["disabled"])]),Pe(($(),pe(q,{data:ne.value,style:{width:"100%"},onSelectionChange:ht},{default:o(()=>[a(d,{type:"selection",width:"55"}),ue("",!0),a(d,{prop:"date",label:"绩效日期","min-width":"120"}),a(d,{prop:"project",label:"生产项目","min-width":"150"}),a(d,{prop:"process",label:"工序","min-width":"80"}),a(d,{prop:"quotaEfficiency",label:"额定效率","min-width":"100"}),a(d,{prop:"actualWorkload",label:"实际工作量","min-width":"120"}),a(d,{prop:"performanceManDays",label:"绩效人天合计","min-width":"140"}),a(d,{label:"操作","min-width":"150"},{default:o(l=>[a(r,{type:"primary",size:"small",onClick:X=>Vt(l.row)},{icon:o(()=>[a(j(ze))]),default:o(()=>[e[105]||(e[105]=m(" 修改 ",-1))]),_:1},8,["onClick"]),a(r,{type:"danger",size:"small",onClick:X=>St(l.row.id)},{icon:o(()=>[a(j(L))]),default:o(()=>[e[106]||(e[106]=m(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Me,qe.value]]),f("div",_a,[a(de,{"current-page":z.current,"onUpdate:currentPage":e[17]||(e[17]=l=>z.current=l),"page-size":z.pageSize,"onUpdate:pageSize":e[18]||(e[18]=l=>z.pageSize=l),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:z.total,onSizeChange:Ct,onCurrentChange:Rt},null,8,["current-page","page-size","total"])]),a(F,{modelValue:oe.value,"onUpdate:modelValue":e[26]||(e[26]=l=>oe.value=l),title:Ae.value?"修改绩效记录":"添加绩效记录",width:"600px"},{footer:o(()=>[f("span",Fa,[a(r,{onClick:e[25]||(e[25]=l=>oe.value=!1)},{default:o(()=>[...e[107]||(e[107]=[m("取消",-1)])]),_:1}),a(r,{type:"primary",onClick:wt},{default:o(()=>[...e[108]||(e[108]=[m("保存",-1)])]),_:1})])]),default:o(()=>[a(we,{ref_key:"workReportFormRef",ref:G,model:u,rules:it,"label-width":"120px"},{default:o(()=>[a(p,{label:"绩效日期",prop:"date"},{default:o(()=>[a(k,{modelValue:u.date,"onUpdate:modelValue":e[19]||(e[19]=l=>u.date=l),type:"date",placeholder:"请选择绩效日期",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",required:""},null,8,["modelValue"])]),_:1}),a(p,{label:"生产项目",prop:"project"},{default:o(()=>[a(S,{modelValue:u.project,"onUpdate:modelValue":e[20]||(e[20]=l=>u.project=l),placeholder:"请选择生产项目",style:{width:"100%"},required:"",onChange:bt},{default:o(()=>[($(!0),he(et,null,tt(fe.value,l=>($(),pe(V,{key:l.id,label:l.projectName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"工序",prop:"process"},{default:o(()=>[a(S,{modelValue:u.process,"onUpdate:modelValue":e[21]||(e[21]=l=>u.process=l),placeholder:"请选择工序",style:{width:"100%"},required:"",onChange:Qe},{default:o(()=>[a(V,{label:"作业",value:"作业"}),a(V,{label:"质检",value:"质检"})]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"额定效率",prop:"quotaEfficiency"},{default:o(()=>[a(b,{modelValue:u.quotaEfficiency,"onUpdate:modelValue":e[22]||(e[22]=l=>u.quotaEfficiency=l),min:1,placeholder:"额定效率",style:{width:"100%"},disabled:!0},null,8,["modelValue"])]),_:1}),a(p,{label:"实际工作量",prop:"actualWorkload"},{default:o(()=>[a(b,{modelValue:u.actualWorkload,"onUpdate:modelValue":e[23]||(e[23]=l=>u.actualWorkload=l),min:1,placeholder:"请输入实际工作量",style:{width:"100%"},onChange:Ke},null,8,["modelValue"])]),_:1}),a(p,{label:"绩效人天合计",prop:"performanceManDays"},{default:o(()=>[a(be,{modelValue:u.performanceManDays,"onUpdate:modelValue":e[24]||(e[24]=l=>u.performanceManDays=l),placeholder:"绩效人天合计",style:{width:"100%"},disabled:!0},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])]),_:1},8,["modelValue"]),a(F,{modelValue:ce.value,"onUpdate:modelValue":e[69]||(e[69]=l=>ce.value=l),title:"工资记录",width:"90%","max-width":"1200px"},{default:o(()=>[f("div",Ia,[a(r,{type:"primary",onClick:xt},{icon:o(()=>[a(j(Ue))]),default:o(()=>[e[109]||(e[109]=m(" 添加工资记录 ",-1))]),_:1}),a(r,{type:"danger",disabled:N.value.length===0,onClick:Et},{icon:o(()=>[a(j(L))]),default:o(()=>[e[110]||(e[110]=m(" 批量删除 ",-1))]),_:1},8,["disabled"])]),Pe(($(),pe(q,{data:O.value,style:{width:"100%"},onSelectionChange:jt},{default:o(()=>[a(d,{type:"selection",width:"55"}),ue("",!0),a(d,{prop:"yearMonth",label:"年月","min-width":"100"}),a(d,{prop:"periodStart",label:"周期开始","min-width":"120"},{default:o(l=>[m(Z(Ze(l.row.periodStart)),1)]),_:1}),a(d,{prop:"periodEnd",label:"周期结束","min-width":"120"},{default:o(l=>[m(Z(Ze(l.row.periodEnd)),1)]),_:1}),a(d,{prop:"attendanceDays",label:"出勤天数","min-width":"100"}),a(d,{prop:"baseSalary",label:"基本薪资","min-width":"120"}),a(d,{prop:"performance",label:"绩效系数","min-width":"100"}),a(d,{prop:"performanceSalary",label:"绩效薪资","min-width":"120"}),a(d,{prop:"totalIncome",label:"应发总额","min-width":"120"}),a(d,{prop:"totalDeduction",label:"扣除总额","min-width":"120"}),a(d,{prop:"netSalary",label:"实发薪资","min-width":"120"}),a(d,{label:"操作","min-width":"150"},{default:o(l=>[a(r,{type:"primary",size:"small",onClick:X=>Ut(l.row)},{icon:o(()=>[a(j(ze))]),default:o(()=>[e[111]||(e[111]=m(" 修改 ",-1))]),_:1},8,["onClick"]),a(r,{type:"danger",size:"small",onClick:X=>zt(l.row.id)},{icon:o(()=>[a(j(L))]),default:o(()=>[e[112]||(e[112]=m(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Me,$e.value]]),f("div",Oa,[a(de,{"current-page":E.current,"onUpdate:currentPage":e[28]||(e[28]=l=>E.current=l),"page-size":E.pageSize,"onUpdate:pageSize":e[29]||(e[29]=l=>E.pageSize=l),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:E.total,onSizeChange:At,onCurrentChange:Yt},null,8,["current-page","page-size","total"])]),a(F,{modelValue:ee.value,"onUpdate:modelValue":e[55]||(e[55]=l=>ee.value=l),title:De.value?"修改工资记录":"添加工资记录",width:"800px"},{footer:o(()=>[f("span",La,[a(r,{onClick:e[53]||(e[53]=l=>me.value=!0)},{default:o(()=>[...e[113]||(e[113]=[m("默认配置",-1)])]),_:1}),a(r,{onClick:e[54]||(e[54]=l=>ee.value=!1)},{default:o(()=>[...e[114]||(e[114]=[m("取消",-1)])]),_:1}),a(r,{type:"primary",onClick:Pt},{default:o(()=>[...e[115]||(e[115]=[m("保存",-1)])]),_:1})])]),default:o(()=>[a(we,{ref_key:"salaryRecordFormRef",ref:J,model:n,rules:st,"label-width":"120px"},{default:o(()=>[f("div",Na,[f("div",Wa,[a(p,{label:"年月",prop:"yearMonth"},{default:o(()=>[a(k,{modelValue:n.yearMonth,"onUpdate:modelValue":e[30]||(e[30]=l=>n.yearMonth=l),type:"month",placeholder:"请选择年月",style:{width:"100%"},format:"YYYY-MM","value-format":"YYYY-MM",required:"",onChange:Mt},null,8,["modelValue"])]),_:1}),a(p,{label:"周期开始日期",prop:"periodStart"},{default:o(()=>[a(k,{modelValue:n.periodStart,"onUpdate:modelValue":e[31]||(e[31]=l=>n.periodStart=l),type:"date",placeholder:"请选择周期开始日期",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",required:"",disabled:""},null,8,["modelValue"])]),_:1}),a(p,{label:"周期结束日期",prop:"periodEnd"},{default:o(()=>[a(k,{modelValue:n.periodEnd,"onUpdate:modelValue":e[32]||(e[32]=l=>n.periodEnd=l),type:"date",placeholder:"请选择周期结束日期",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",required:"",disabled:""},null,8,["modelValue"])]),_:1}),a(p,{label:"出勤天数",prop:"attendanceDays"},{default:o(()=>[a(b,{modelValue:n.attendanceDays,"onUpdate:modelValue":e[33]||(e[33]=l=>n.attendanceDays=l),min:0,placeholder:"请输入出勤天数",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"基本薪资",prop:"baseSalary"},{default:o(()=>[a(b,{modelValue:n.baseSalary,"onUpdate:modelValue":e[34]||(e[34]=l=>n.baseSalary=l),min:0,step:.01,placeholder:"请输入基本薪资",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"绩效系数/评分",prop:"performance"},{default:o(()=>[a(b,{modelValue:n.performance,"onUpdate:modelValue":e[35]||(e[35]=l=>n.performance=l),min:0,step:.01,placeholder:"请输入绩效系数/评分",style:{width:"100%"},onChange:e[36]||(e[36]=()=>{Je(),ve()})},null,8,["modelValue"])]),_:1}),a(p,{label:"绩效薪资",prop:"performanceSalary"},{default:o(()=>[a(b,{modelValue:n.performanceSalary,"onUpdate:modelValue":e[37]||(e[37]=l=>n.performanceSalary=l),min:0,step:.01,placeholder:"请输入绩效薪资",style:{width:"100%"},disabled:""},null,8,["modelValue"])]),_:1}),a(p,{label:"岗位绩效",prop:"positionPerformance"},{default:o(()=>[a(b,{modelValue:n.positionPerformance,"onUpdate:modelValue":e[38]||(e[38]=l=>n.positionPerformance=l),min:0,step:.01,placeholder:"请输入岗位绩效",style:{width:"100%"},onChange:ve},null,8,["modelValue"])]),_:1}),a(p,{label:"餐补",prop:"mealAllowance"},{default:o(()=>[a(b,{modelValue:n.mealAllowance,"onUpdate:modelValue":e[39]||(e[39]=l=>n.mealAllowance=l),min:0,step:.01,placeholder:"请输入餐补",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"房补",prop:"housingAllowance"},{default:o(()=>[a(b,{modelValue:n.housingAllowance,"onUpdate:modelValue":e[40]||(e[40]=l=>n.housingAllowance=l),min:0,step:.01,placeholder:"请输入房补",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"全勤奖",prop:"fullAttendance"},{default:o(()=>[a(b,{modelValue:n.fullAttendance,"onUpdate:modelValue":e[41]||(e[41]=l=>n.fullAttendance=l),min:0,step:.01,placeholder:"请输入全勤奖",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),f("div",Ta,[a(p,{label:"其他奖金",prop:"otherBonus"},{default:o(()=>[a(b,{modelValue:n.otherBonus,"onUpdate:modelValue":e[42]||(e[42]=l=>n.otherBonus=l),min:0,step:.01,placeholder:"请输入其他奖金",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"养老保险",prop:"pension"},{default:o(()=>[a(b,{modelValue:n.pension,"onUpdate:modelValue":e[43]||(e[43]=l=>n.pension=l),min:0,step:.01,placeholder:"请输入养老保险",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"医疗保险",prop:"medical"},{default:o(()=>[a(b,{modelValue:n.medical,"onUpdate:modelValue":e[44]||(e[44]=l=>n.medical=l),min:0,step:.01,placeholder:"请输入医疗保险",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"失业保险",prop:"unemployment"},{default:o(()=>[a(b,{modelValue:n.unemployment,"onUpdate:modelValue":e[45]||(e[45]=l=>n.unemployment=l),min:0,step:.01,placeholder:"请输入失业保险",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"迟到分钟",prop:"lateDeduction"},{default:o(()=>[a(b,{modelValue:n.lateDeduction,"onUpdate:modelValue":e[46]||(e[46]=l=>n.lateDeduction=l),min:0,step:1,placeholder:"请输入迟到分钟",style:{width:"100%"},onChange:ve},null,8,["modelValue"])]),_:1}),a(p,{label:"加班时长(小时)",prop:"overtimeHours"},{default:o(()=>[a(b,{modelValue:n.overtimeHours,"onUpdate:modelValue":e[47]||(e[47]=l=>n.overtimeHours=l),min:0,step:.5,placeholder:"请输入加班时长",style:{width:"100%"},onChange:e[48]||(e[48]=()=>{Ge(),ve()})},null,8,["modelValue"])]),_:1}),a(p,{label:"加班薪资",prop:"overtimeSalary"},{default:o(()=>[a(b,{modelValue:n.overtimeSalary,"onUpdate:modelValue":e[49]||(e[49]=l=>n.overtimeSalary=l),min:0,step:.01,placeholder:"请输入加班薪资",style:{width:"100%"},disabled:""},null,8,["modelValue"])]),_:1}),a(p,{label:"应发总额",prop:"totalIncome"},{default:o(()=>[a(b,{modelValue:n.totalIncome,"onUpdate:modelValue":e[50]||(e[50]=l=>n.totalIncome=l),min:0,step:.01,placeholder:"请输入应发总额",style:{width:"100%"},disabled:""},null,8,["modelValue"])]),_:1}),a(p,{label:"扣除总额",prop:"totalDeduction"},{default:o(()=>[a(b,{modelValue:n.totalDeduction,"onUpdate:modelValue":e[51]||(e[51]=l=>n.totalDeduction=l),min:0,step:.01,placeholder:"请输入扣除总额",style:{width:"100%"},disabled:""},null,8,["modelValue"])]),_:1}),a(p,{label:"实发薪资",prop:"netSalary"},{default:o(()=>[a(b,{modelValue:n.netSalary,"onUpdate:modelValue":e[52]||(e[52]=l=>n.netSalary=l),min:0,step:.01,placeholder:"请输入实发薪资",style:{width:"100%"},disabled:""},null,8,["modelValue"])]),_:1})])])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),a(F,{modelValue:me.value,"onUpdate:modelValue":e[68]||(e[68]=l=>me.value=l),title:"薪资记录默认配置",width:"600px"},{footer:o(()=>[f("span",Ja,[a(r,{onClick:e[67]||(e[67]=l=>me.value=!1)},{default:o(()=>[...e[116]||(e[116]=[m("取消",-1)])]),_:1}),a(r,{type:"primary",onClick:nt},{default:o(()=>[...e[117]||(e[117]=[m("保存",-1)])]),_:1})])]),default:o(()=>[a(we,{model:v,"label-width":"120px"},{default:o(()=>[f("div",Ha,[f("div",Qa,[a(p,{label:"出勤天数"},{default:o(()=>[a(b,{modelValue:v.attendanceDays,"onUpdate:modelValue":e[56]||(e[56]=l=>v.attendanceDays=l),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"基本薪资"},{default:o(()=>[a(b,{modelValue:v.baseSalary,"onUpdate:modelValue":e[57]||(e[57]=l=>v.baseSalary=l),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"绩效系数/评分"},{default:o(()=>[a(b,{modelValue:v.performance,"onUpdate:modelValue":e[58]||(e[58]=l=>v.performance=l),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"岗位绩效"},{default:o(()=>[a(b,{modelValue:v.positionPerformance,"onUpdate:modelValue":e[59]||(e[59]=l=>v.positionPerformance=l),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"餐补"},{default:o(()=>[a(b,{modelValue:v.mealAllowance,"onUpdate:modelValue":e[60]||(e[60]=l=>v.mealAllowance=l),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),f("div",Ka,[a(p,{label:"房补"},{default:o(()=>[a(b,{modelValue:v.housingAllowance,"onUpdate:modelValue":e[61]||(e[61]=l=>v.housingAllowance=l),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"全勤奖"},{default:o(()=>[a(b,{modelValue:v.fullAttendance,"onUpdate:modelValue":e[62]||(e[62]=l=>v.fullAttendance=l),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"其他奖金"},{default:o(()=>[a(b,{modelValue:v.otherBonus,"onUpdate:modelValue":e[63]||(e[63]=l=>v.otherBonus=l),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"养老保险"},{default:o(()=>[a(b,{modelValue:v.pension,"onUpdate:modelValue":e[64]||(e[64]=l=>v.pension=l),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"医疗保险"},{default:o(()=>[a(b,{modelValue:v.medical,"onUpdate:modelValue":e[65]||(e[65]=l=>v.medical=l),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"失业保险"},{default:o(()=>[a(b,{modelValue:v.unemployment,"onUpdate:modelValue":e[66]||(e[66]=l=>v.unemployment=l),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1})])])]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),a(F,{modelValue:Ve.value,"onUpdate:modelValue":e[78]||(e[78]=l=>Ve.value=l),title:"加班汇报",width:"90%","max-width":"1000px"},{default:o(()=>[f("div",Ga,[a(r,{type:"primary",onClick:$t},{icon:o(()=>[a(j(Ue))]),default:o(()=>[e[118]||(e[118]=m(" 添加加班记录 ",-1))]),_:1}),a(r,{type:"danger",disabled:I.value.length===0,onClick:It},{icon:o(()=>[a(j(L))]),default:o(()=>[e[119]||(e[119]=m(" 批量删除 ",-1))]),_:1},8,["disabled"])]),Pe(($(),pe(q,{data:le.value,style:{width:"100%"},onSelectionChange:qt},{default:o(()=>[a(d,{type:"selection",width:"55"}),ue("",!0),a(d,{prop:"reportDate",label:"汇报日期","min-width":"120"}),a(d,{prop:"overtimeHours",label:"加班小时数","min-width":"120"}),a(d,{prop:"projectName",label:"项目名称","min-width":"150"}),a(d,{prop:"description",label:"加班描述","min-width":"200"}),a(d,{prop:"status",label:"状态","min-width":"100"},{default:o(l=>[a(Y,{type:l.row.status==="pending"?"warning":l.row.status==="approved"?"success":"danger"},{default:o(()=>[m(Z(l.row.status==="pending"?"待审批":l.row.status==="approved"?"已通过":"已拒绝"),1)]),_:2},1032,["type"])]),_:1}),a(d,{prop:"createdAt",label:"创建时间","min-width":"180"}),a(d,{label:"操作","min-width":"150"},{default:o(l=>[a(r,{type:"primary",size:"small",onClick:X=>Bt(l.row)},{icon:o(()=>[a(j(ze))]),default:o(()=>[e[120]||(e[120]=m(" 修改 ",-1))]),_:1},8,["onClick"]),a(r,{type:"danger",size:"small",onClick:X=>Ft(l.row.id)},{icon:o(()=>[a(j(L))]),default:o(()=>[e[121]||(e[121]=m(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Me,Ee.value]]),f("div",Xa,[a(de,{"current-page":P.current,"onUpdate:currentPage":e[70]||(e[70]=l=>P.current=l),"page-size":P.pageSize,"onUpdate:pageSize":e[71]||(e[71]=l=>P.pageSize=l),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:P.total,onSizeChange:Ot,onCurrentChange:Nt},null,8,["current-page","page-size","total"])]),a(F,{modelValue:te.value,"onUpdate:modelValue":e[77]||(e[77]=l=>te.value=l),title:ae.value?"修改加班记录":"添加加班记录",width:"600px"},{footer:o(()=>[f("span",Za,[a(r,{onClick:e[76]||(e[76]=l=>te.value=!1)},{default:o(()=>[...e[122]||(e[122]=[m("取消",-1)])]),_:1}),a(r,{type:"primary",onClick:_t},{default:o(()=>[...e[123]||(e[123]=[m("保存",-1)])]),_:1})])]),default:o(()=>[a(we,{ref_key:"overtimeReportFormRef",ref:Q,model:h,rules:ot,"label-width":"120px"},{default:o(()=>[a(p,{label:"汇报日期",prop:"reportDate"},{default:o(()=>[a(k,{modelValue:h.reportDate,"onUpdate:modelValue":e[72]||(e[72]=l=>h.reportDate=l),type:"date",placeholder:"请选择汇报日期",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",required:""},null,8,["modelValue"])]),_:1}),a(p,{label:"加班小时数",prop:"overtimeHours"},{default:o(()=>[a(b,{modelValue:h.overtimeHours,"onUpdate:modelValue":e[73]||(e[73]=l=>h.overtimeHours=l),min:.5,step:.5,placeholder:"请输入加班小时数",style:{width:"100%"},required:""},null,8,["modelValue"])]),_:1}),a(p,{label:"项目名称",prop:"projectName"},{default:o(()=>[a(be,{modelValue:h.projectName,"onUpdate:modelValue":e[74]||(e[74]=l=>h.projectName=l),placeholder:"请输入项目名称（可选）",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"加班描述",prop:"description"},{default:o(()=>[a(be,{modelValue:h.description,"onUpdate:modelValue":e[75]||(e[75]=l=>h.description=l),type:"textarea",placeholder:"请输入加班描述（可选）",rows:"4",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])]),_:1},8,["modelValue"])])}}}),nl=aa(el,[["__scopeId","data-v-049a1085"]]);export{nl as default};
