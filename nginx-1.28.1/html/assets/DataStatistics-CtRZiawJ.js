import{d as Zt,S as xe,k as ea,W as ta,c as ye,a as g,b as a,w as l,C as ve,D as J,h as y,i as z,E as s,r as U,o as B,g as m,H as Ie,I as Ne,z as oe,e as M,N as Pe,M as G,K as Ue,O as ze,P as X,L as aa}from"./index-BXiqGu-W.js";import{s as j}from"./request-BYh0DQqL.js";import{i as oa,L as ra}from"./index-5QPu3XI4.js";import{_ as la}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-B9ygI19o.js";const at=async f=>await j({url:"/api/project/list",method:"get",params:{uid:f}}),na=async f=>await j({url:"/api/project/add",method:"post",data:f}),sa=async(f,w)=>await j({url:"/api/project/update",method:"put",params:{uid:w},data:f}),ia=async(f,w)=>await j({url:`/api/project/${f}`,method:"delete",params:{uid:w}}),ua=async(f,w)=>await j({url:"/api/project/batchDelete",method:"delete",data:{ids:f,uid:w}}),da=async f=>await j({url:"/api/performance/add",method:"post",data:f}),pa=async(f,w)=>await j({url:"/api/performance/list",method:"get",params:{uid:f,date:w}}),ot=async(f,w,x)=>await j({url:"/api/performance/range",method:"get",params:{uid:f,startDate:w,endDate:x}}),rt=async(f,w)=>await j({url:`/api/performance/${f}`,method:"delete",params:{uid:w}}),ca=async f=>j({url:"/api/salary/add",method:"post",data:f}),ma=async f=>j({url:"/api/salary/update",method:"put",data:f}),fa=async f=>j({url:"/api/salary/list",method:"get",params:{uid:f}}),ga=async(f,w)=>j({url:`/api/salary/${f}`,method:"delete",params:{uid:w}}),ya=async(f,w)=>j({url:"/api/salary/batch",method:"delete",data:{ids:f,uid:w}}),va=async f=>await j({url:"/api/overtime/add",method:"post",data:f}),ba=async f=>await j({url:"/api/overtime/list",method:"get",params:{uid:f}}),wa=async f=>await j({url:"/api/overtime/update",method:"put",data:f}),ha=async(f,w)=>await j({url:`/api/overtime/${f}`,method:"delete",params:{uid:w}}),Da=async(f,w)=>await j({url:"/api/overtime/batch",method:"delete",data:{ids:f,uid:w}}),lt=async(f,w,x)=>await j({url:"/api/overtime/listByDateRange",method:"get",params:{uid:f,startDate:w,endDate:x}}),Sa={class:"data-statistics"},Va={class:"top-bar"},ka={class:"button-group"},Ca={class:"content-area"},Ra={class:"time-range-selector"},ja={key:0,class:"month-select-range"},Ma={key:1,class:"custom-date-range"},xa={class:"performance-summary"},Pa={class:"performance-card"},Ua={class:"performance-value"},za={class:"performance-card"},Ea={class:"performance-value"},Aa={class:"performance-card"},Ya={class:"performance-value"},qa={class:"chart-container"},$a={class:"table-actions"},Ba={class:"pagination"},_a={class:"dialog-footer"},Fa={class:"table-actions"},Oa={class:"pagination"},Ia={class:"dialog-footer"},Na={class:"table-actions"},Wa={class:"pagination"},Ha={class:"form-row"},Ta={class:"form-col"},La={class:"form-col"},Qa={class:"dialog-footer"},Ka={class:"form-row"},Ja={class:"form-col"},Ga={class:"form-col"},Xa={class:"dialog-footer"},Za={class:"table-actions"},eo={class:"pagination"},to={class:"dialog-footer"},ao=Zt({__name:"DataStatistics",setup(f){const w=y(!1),x=y(!1),re=y(!1),le=y(!1),Se=y(!1),be=y(!1),Ve=y(!1),ne=y(!1),se=y(!1),ie=y([]),H=y([]),We=y([]),Ee=y(!1),E=z({current:1,pageSize:10,total:0}),Z=y(),S=z({id:0,reportDate:"",overtimeHours:0,projectName:"",description:""}),nt=z({reportDate:[{required:!0,message:"请选择汇报日期",trigger:"change"}],overtimeHours:[{required:!0,message:"请输入加班小时数",trigger:"blur"},{type:"number",min:.5,message:"加班小时数必须大于等于0.5",trigger:"blur"}]}),b=z({attendanceDays:25,baseSalary:2e3,performance:0,positionPerformance:500,mealAllowance:200,housingAllowance:300,fullAttendance:300,otherBonus:100,pension:360.32,medical:90.08,unemployment:13.51}),st=()=>{try{const t=C();if(!t)return;const e=localStorage.getItem(`salary_default_config_${t.id}`);if(e){const r=JSON.parse(e);Object.assign(b,r)}}catch(t){console.error("加载默认配置失败：",t)}},it=()=>{try{const t=C();if(!t){s.error("请先登录");return}localStorage.setItem(`salary_default_config_${t.id}`,JSON.stringify(b)),s.success("默认配置保存成功"),be.value=!1}catch(t){console.error("保存默认配置失败：",t),s.error("保存默认配置失败")}},ue=y(!1),Ae=y(!1),de=y(!1),ke=y(!1),Ye=y(!1),qe=y(!1),pe=y([]),ce=y([]),ee=y([]),He=y([]),A=z({current:1,pageSize:10,total:0}),T=y([]),L=y([]),Te=y([]),$e=y(!1),Y=z({current:1,pageSize:10,total:0}),te=y(),n=z({id:0,uid:"",yearMonth:"",periodStart:"",periodEnd:"",attendanceDays:0,baseSalary:0,performance:0,performanceSalary:0,positionPerformance:0,mealAllowance:0,housingAllowance:0,fullAttendance:0,otherBonus:0,pension:0,medical:0,unemployment:0,lateDeduction:0,overtimeHours:0,overtimeSalary:0,totalIncome:0,totalDeduction:0,netSalary:0}),ut=z({yearMonth:[{required:!0,message:"请选择年月",trigger:"change"}],periodStart:[{required:!0,message:"请选择周期开始日期",trigger:"change"}],periodEnd:[{required:!0,message:"请选择周期结束日期",trigger:"change"}],attendanceDays:[{required:!0,message:"请输入出勤天数",trigger:"blur"},{type:"number",min:0,message:"出勤天数必须大于等于0",trigger:"blur"}],baseSalary:[{required:!0,message:"请输入基本薪资",trigger:"blur"},{type:"number",min:0,message:"基本薪资必须大于等于0",trigger:"blur"}],performance:[{required:!0,message:"请输入绩效系数/评分",trigger:"blur"},{type:"number",min:0,message:"绩效系数必须大于等于0",trigger:"blur"}],performanceSalary:[{required:!0,message:"请输入绩效薪资",trigger:"blur"},{type:"number",min:0,message:"绩效薪资必须大于等于0",trigger:"blur"}],positionPerformance:[{required:!0,message:"请输入岗位绩效",trigger:"blur"},{type:"number",min:0,message:"岗位绩效必须大于等于0",trigger:"blur"}],mealAllowance:[{required:!0,message:"请输入餐补",trigger:"blur"},{type:"number",min:0,message:"餐补必须大于等于0",trigger:"blur"}],housingAllowance:[{required:!0,message:"请输入房补",trigger:"blur"},{type:"number",min:0,message:"房补必须大于等于0",trigger:"blur"}],fullAttendance:[{required:!0,message:"请输入全勤奖",trigger:"blur"},{type:"number",min:0,message:"全勤奖必须大于等于0",trigger:"blur"}],otherBonus:[{required:!0,message:"请输入其他奖金",trigger:"blur"},{type:"number",min:0,message:"其他奖金必须大于等于0",trigger:"blur"}],pension:[{required:!0,message:"请输入养老保险",trigger:"blur"},{type:"number",min:0,message:"养老保险必须大于等于0",trigger:"blur"}],medical:[{required:!0,message:"请输入医疗保险",trigger:"blur"},{type:"number",min:0,message:"医疗保险必须大于等于0",trigger:"blur"}],unemployment:[{required:!0,message:"请输入失业保险",trigger:"blur"},{type:"number",min:0,message:"失业保险必须大于等于0",trigger:"blur"}],lateDeduction:[{type:"number",min:0,message:"迟到分钟必须大于等于0",trigger:"blur"}],overtimeHours:[{type:"number",min:0,message:"加班时长必须大于等于0",trigger:"blur"}],overtimeSalary:[{type:"number",min:0,message:"加班薪资必须大于等于0",trigger:"blur"}],totalIncome:[{required:!0,message:"请输入应发总额",trigger:"blur"},{type:"number",min:0,message:"应发总额必须大于等于0",trigger:"blur"}],totalDeduction:[{required:!0,message:"请输入扣除总额",trigger:"blur"},{type:"number",min:0,message:"扣除总额必须大于等于0",trigger:"blur"}],netSalary:[{required:!0,message:"请输入实发薪资",trigger:"blur"},{type:"number",min:0,message:"实发薪资必须大于等于0",trigger:"blur"}]}),I=y("month"),Q=y([]),we=y(""),Le=y([]),me=z({totalPerformance:"0.00000",attendanceDays:0,avgPerformance:"0.00000"}),Be=y();let he=null;const Qe=y(!1),ae=y(),d=z({id:0,date:"",project:null,process:"",quotaEfficiency:0,actualWorkload:0,performanceManDays:"0.00000"}),dt=z({date:[{required:!0,message:"请选择绩效日期",trigger:"change"}],project:[{required:!0,message:"请选择生产项目",trigger:"change"}],process:[{required:!0,message:"请选择工序",trigger:"change"}],actualWorkload:[{required:!0,message:"请输入实际工作量",trigger:"blur"},{type:"number",min:1,message:"实际工作量必须大于0",trigger:"blur"}]}),N=y([]),K=y([]),Ke=y([]),q=z({current:1,pageSize:10,total:0}),V=z({id:0,projectCode:"",projectName:"",uid:0,workQuotaEfficiency:0,inspectQuotaEfficiency:0,status:1}),_e=y(),pt=z({projectCode:[{required:!0,message:"请输入项目编码",trigger:"blur"},{min:1,max:50,message:"项目编码长度不能超过50个字符",trigger:"blur"}],projectName:[{required:!0,message:"请输入项目名称",trigger:"blur"},{min:1,max:100,message:"项目名称长度不能超过100个字符",trigger:"blur"}],workQuotaEfficiency:[{required:!1,message:"请输入作业工序额定效率",trigger:"blur"},{type:"number",min:0,message:"作业工序额定效率必须大于等于0",trigger:"blur"}],inspectQuotaEfficiency:[{required:!1,message:"请输入质检工序额定效率",trigger:"blur"},{type:"number",min:0,message:"质检工序额定效率必须大于等于0",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]}),C=()=>{const t=localStorage.getItem("userInfo");return t?JSON.parse(t):null},Ce=async()=>{try{Ye.value=!0;const t=C();if(!t){s.error("请先登录");return}const e=await at(t.id);if(e.code===200&&e.success){const r=e.data;q.total=r.length;const i=(q.current-1)*q.pageSize,c=i+q.pageSize;N.value=r.slice(i,c)}else s.error("获取项目列表失败："+e.message)}catch(t){console.error("获取项目列表失败：",t),s.error("获取项目列表失败")}finally{Ye.value=!1}},ct=t=>{Ke.value=t,K.value=t.map(e=>e.id)},mt=()=>{V.id=0,V.projectCode="",V.projectName="",V.status=1,V.workQuotaEfficiency=0,V.inspectQuotaEfficiency=0;const t=C();t&&(V.uid=t.id),ke.value=!1,de.value=!0},ft=t=>{V.id=t.id,V.projectCode=t.projectCode,V.projectName=t.projectName,V.status=t.status,V.workQuotaEfficiency=t.workQuotaEfficiency||0,V.inspectQuotaEfficiency=t.inspectQuotaEfficiency||0,ke.value=!0,de.value=!0},gt=async()=>{if(_e.value)try{await _e.value.validate();const t=C();if(!t){s.error("请先登录");return}if(ke.value){const e=await sa(V,t.id);if(e.code===200&&e.success){const r=N.value.findIndex(i=>i.id===V.id);if(r!==-1){const i=N.value[r];i&&(N.value[r]={...V,uid:i.uid,createdAt:i.createdAt,updatedAt:new Date().toISOString()})}s.success("项目修改成功")}else{let r=e.message;r.includes("Duplicate entry")&&r.includes("project_code")&&(r="项目编码已存在，请使用其他编码"),s.error("项目修改失败："+r)}}else{V.uid=t.id;const e=await na(V);if(e.code===200&&e.success)await Ce(),s.success("项目添加成功");else{let r=e.message;r.includes("Duplicate entry")&&r.includes("project_code")&&(r="项目编码已存在，请使用其他编码"),s.error("项目添加失败："+r)}}de.value=!1}catch(t){console.error("保存项目失败：",t),s.error("保存项目失败")}},yt=t=>{X.confirm("确定要删除这个项目吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const e=C();if(!e){s.error("请先登录");return}const r=await ia(t,e.id);r.code===200&&r.success?(N.value=N.value.filter(i=>i.id!==t),q.total--,s.success("项目删除成功")):s.error("项目删除失败："+r.message)}catch(e){console.error("删除项目失败：",e),s.error("删除项目失败")}}).catch(()=>{})},vt=()=>{if(K.value.length===0){s.warning("请选择要删除的项目");return}X.confirm(`确定要删除选中的 ${K.value.length} 个项目吗？`,"批量删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const t=C();if(!t){s.error("请先登录");return}const e=await ua(K.value,t.id);e.code===200&&e.success?(N.value=N.value.filter(r=>!K.value.includes(r.id)),q.total-=K.value.length,K.value=[],Ke.value=[],s.success("批量删除成功")):s.error("批量删除失败："+e.message)}catch(t){console.error("批量删除项目失败：",t),s.error("批量删除项目失败")}}).catch(()=>{})},bt=t=>{q.pageSize=t,Ce()},wt=t=>{q.current=t,Ce()};xe(()=>w.value,t=>{t&&Ce()});const Fe=async()=>{try{const t=C();if(!t){s.error("请先登录");return}const e=await at(t.id);e.code===200&&e.success?pe.value=e.data:s.error("获取生产项目列表失败："+e.message)}catch(t){console.error("获取生产项目列表失败：",t),s.error("获取生产项目列表失败")}},ht=()=>{Je()},Je=()=>{if(d.project&&d.process){const t=pe.value.find(e=>e.id===d.project);t&&(d.process==="作业"?d.quotaEfficiency=t.workQuotaEfficiency||0:d.process==="质检"&&(d.quotaEfficiency=t.inspectQuotaEfficiency||0),Ge())}},Ge=()=>{if(d.quotaEfficiency>0&&d.actualWorkload>0){const t=d.actualWorkload/d.quotaEfficiency;d.performanceManDays=t.toFixed(5)}else d.performanceManDays="0.00000"},Dt=async()=>{if(ae.value)try{await ae.value.validate();const t=C();if(!t){s.error("请先登录");return}const e=pe.value.find(c=>c.id===d.project);if(!e){s.error("请选择有效的生产项目");return}const r={uid:t.id,date:d.date,project:e.projectName,process:d.process,quotaEfficiency:d.quotaEfficiency,actualWorkload:d.actualWorkload,performanceManDays:parseFloat(d.performanceManDays)},i=await da(r);if(i.code===200&&i.success)s.success("工作汇报保存成功"),ue.value=!1,await Re(),d.id=0,d.date="",d.project=null,d.process="",d.quotaEfficiency=0,d.actualWorkload=0,d.performanceManDays="0.00000";else{let c=i.message;(c.includes("Duplicate entry")||c.includes("重复"))&&(c="该绩效记录已存在，请检查日期和项目"),s.error("工作汇报保存失败："+c)}}catch(t){console.error("保存工作汇报失败：",t),s.error("保存工作汇报失败")}},Re=async()=>{try{qe.value=!0;const t=C();if(!t){s.error("请先登录");return}const e=await pa(t.id);if(e.code===200&&e.success){const r=e.data;A.total=r.length;const i=(A.current-1)*A.pageSize,c=i+A.pageSize;ce.value=r.slice(i,c)}else s.error("获取绩效记录列表失败："+e.message)}catch(t){console.error("获取绩效记录列表失败：",t),s.error("获取绩效记录列表失败")}finally{qe.value=!1}},St=t=>{He.value=t,ee.value=t.map(e=>e.id)},Vt=()=>{d.id=0,d.date="",d.project=null,d.process="",d.quotaEfficiency=0,d.actualWorkload=0,d.performanceManDays="0.00000",ae.value&&ae.value.resetFields(),Ae.value=!1,ue.value=!0},kt=async t=>{ae.value&&ae.value.resetFields(),Ae.value=!0,ue.value=!0,await Fe(),d.id=t.id,d.date=t.date;const e=pe.value.find(r=>r.projectName===t.project);d.project=e?e.id:null,d.process=t.process,d.quotaEfficiency=t.quotaEfficiency,d.actualWorkload=t.actualWorkload,d.performanceManDays=t.performanceManDays.toString()},Ct=t=>{X.confirm("确定要删除这条绩效记录吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const e=C();if(!e){s.error("请先登录");return}const r=await rt(t,e.id);r.code===200&&r.success?(ce.value=ce.value.filter(i=>i.id!==t),A.total--,s.success("绩效记录删除成功")):s.error("绩效记录删除失败："+r.message)}catch(e){console.error("删除绩效记录失败：",e),s.error("删除绩效记录失败")}}).catch(()=>{})},Rt=()=>{if(ee.value.length===0){s.warning("请选择要删除的绩效记录");return}X.confirm(`确定要删除选中的 ${ee.value.length} 条绩效记录吗？`,"批量删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const t=C();if(!t){s.error("请先登录");return}let e=0;for(const r of ee.value){const i=await rt(r,t.id);i.code===200&&i.success&&e++}ce.value=ce.value.filter(r=>!ee.value.includes(r.id)),A.total-=e,ee.value=[],He.value=[],s.success(`批量删除成功，共删除 ${e} 条绩效记录`)}catch(t){console.error("批量删除绩效记录失败：",t),s.error("批量删除绩效记录失败")}}).catch(()=>{})},jt=t=>{A.pageSize=t,Re()},Mt=t=>{A.current=t,Re()},je=async()=>{try{$e.value=!0;const t=C();if(!t){s.error("请先登录");return}const e=await fa(t.id);if(e.code===200&&e.success){const r=e.data;Y.total=r.length;const i=(Y.current-1)*Y.pageSize,c=i+Y.pageSize;T.value=r.slice(i,c)}else s.error("获取工资记录列表失败："+e.message)}catch(t){console.error("获取工资记录列表失败：",t),s.error("获取工资记录列表失败")}finally{$e.value=!1}},xt=t=>{Te.value=t,L.value=t.map(e=>e.id)},Xe=()=>{n.performanceSalary=170*.94*n.performance},Ze=()=>{n.overtimeSalary=n.overtimeHours*17},De=()=>{const t=n.attendanceDays*8*60,e=t-n.lateDeduction,r=t>0?e/t:0,i=n.baseSalary*r,c=n.positionPerformance*r,h=n.mealAllowance*r,D=n.housingAllowance*r;n.totalIncome=i+n.performanceSalary+c+h+D+n.fullAttendance+n.otherBonus+n.overtimeSalary,n.totalDeduction=n.pension+n.medical+n.unemployment,n.netSalary=n.totalIncome-n.totalDeduction},Pt=async()=>{if(!n.yearMonth)return;const[t,e]=n.yearMonth.split("-");if(!t||!e)return;const r=parseInt(t),i=parseInt(e);let c=r,h=i-1;h===0&&(c--,h=12);const D=`${c}-${String(h).padStart(2,"0")}-26`,k=`${r}-${e}-25`;n.periodStart=D,n.periodEnd=k;const u=C();if(u)try{const R=await lt(u.id,D,k);let P=0;R.code===200&&R.success&&(P=R.data.reduce((p,v)=>p+parseFloat(v.overtimeHours?.toString()||"0"),0),n.overtimeHours=P);const $=await ot(u.id,D,k);if($.code===200&&$.success){const F=$.data,p=F.reduce((o,W)=>o+parseFloat(W.performanceManDays.toString()),0),O=new Set(F.map(o=>o.date)).size;let _=p-O;const ge=P/8;_-=ge,n.attendanceDays=O,n.performance=_}}catch(R){console.error("获取数据失败：",R)}Xe(),Ze(),De()},Ut=()=>{n.id=0,n.uid="",n.yearMonth="",n.periodStart="",n.periodEnd="",n.attendanceDays=b.attendanceDays,n.baseSalary=b.baseSalary,n.performance=b.performance,n.performanceSalary=0,n.positionPerformance=b.positionPerformance,n.mealAllowance=b.mealAllowance,n.housingAllowance=b.housingAllowance,n.fullAttendance=b.fullAttendance,n.otherBonus=b.otherBonus,n.pension=b.pension,n.medical=b.medical,n.unemployment=b.unemployment,n.lateDeduction=0,n.overtimeHours=0,n.overtimeSalary=0,n.totalIncome=0,n.totalDeduction=0,n.netSalary=0,te.value&&te.value.resetFields(),Se.value=!1,le.value=!0},zt=t=>{te.value&&te.value.resetFields(),n.id=t.id,n.uid=t.uid,n.yearMonth=t.yearMonth,n.periodStart=t.periodStart,n.periodEnd=t.periodEnd,n.attendanceDays=t.attendanceDays,n.baseSalary=t.baseSalary,n.performance=t.performance,n.performanceSalary=t.performanceSalary,n.positionPerformance=t.positionPerformance,n.mealAllowance=t.mealAllowance,n.housingAllowance=t.housingAllowance,n.fullAttendance=t.fullAttendance,n.otherBonus=t.otherBonus,n.pension=t.pension,n.medical=t.medical,n.unemployment=t.unemployment,n.lateDeduction=t.lateDeduction,n.overtimeHours=t.overtimeHours,n.overtimeSalary=t.overtimeSalary,n.totalIncome=t.totalIncome,n.totalDeduction=t.totalDeduction,n.netSalary=t.netSalary,Se.value=!0,le.value=!0},Et=async()=>{if(te.value)try{await te.value.validate();const t=C();if(!t){s.error("请先登录");return}if(n.uid=t.id,Se.value){const e=await ma(n);if(e.code===200&&e.success){const r=T.value.findIndex(i=>i.id===n.id);r!==-1&&(T.value[r]={...n}),s.success("工资记录修改成功")}else s.error("工资记录修改失败："+e.message)}else{const e=await ca(n);if(e.code===200&&e.success)await je(),s.success("工资记录添加成功");else{let r=e.message;r.includes("Duplicate entry")&&r.includes("idx_uid_month")&&(r="该月份的工资记录已存在，请修改或删除原记录后重新添加"),s.error("工资记录添加失败："+r)}}le.value=!1}catch(t){console.error("保存工资记录失败：",t),s.error("保存工资记录失败")}},At=t=>{X.confirm("确定要删除这条工资记录吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const e=C();if(!e){s.error("请先登录");return}const r=await ga(t,e.id);r.code===200&&r.success?(T.value=T.value.filter(i=>i.id!==t),Y.total--,s.success("工资记录删除成功")):s.error("工资记录删除失败："+r.message)}catch(e){console.error("删除工资记录失败：",e),s.error("删除工资记录失败")}}).catch(()=>{})},Yt=()=>{if(L.value.length===0){s.warning("请选择要删除的工资记录");return}X.confirm(`确定要删除选中的 ${L.value.length} 条工资记录吗？`,"批量删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const t=C();if(!t){s.error("请先登录");return}const e=await ya(L.value,t.id);e.code===200&&e.success?(T.value=T.value.filter(r=>!L.value.includes(r.id)),Y.total-=L.value.length,L.value=[],Te.value=[],s.success("批量删除成功")):s.error("批量删除失败："+e.message)}catch(t){console.error("批量删除工资记录失败：",t),s.error("批量删除工资记录失败")}}).catch(()=>{})},qt=t=>{Y.pageSize=t,je()},$t=t=>{Y.current=t,je()};xe(()=>x.value,t=>{t&&(Fe(),Re())}),xe(()=>re.value,t=>{t&&je()}),xe(()=>Ve.value,t=>{t&&(Fe(),Me())});const Me=async()=>{try{Ee.value=!0;const t=C();if(!t){s.error("请先登录");return}const e=await ba(t.id);if(e.code===200&&e.success){const r=e.data;E.total=r.length;const i=(E.current-1)*E.pageSize,c=i+E.pageSize;ie.value=r.slice(i,c)}else s.error("获取加班记录列表失败："+e.message)}catch(t){console.error("获取加班记录列表失败：",t),s.error("获取加班记录列表失败")}finally{Ee.value=!1}},Bt=t=>{We.value=t,H.value=t.map(e=>e.id)},_t=()=>{S.id=0,S.reportDate="",S.overtimeHours=0,S.projectName="",S.description="",Z.value&&Z.value.resetFields(),se.value=!1,ne.value=!0},Ft=t=>{Z.value&&Z.value.resetFields(),S.id=t.id,S.reportDate=t.reportDate,S.overtimeHours=t.overtimeHours,S.projectName=t.projectName||"",S.description=t.description||"",se.value=!0,ne.value=!0},Ot=async()=>{if(Z.value)try{await Z.value.validate();const t=C();if(!t){s.error("请先登录");return}const e={uid:t.id,reportDate:S.reportDate,overtimeHours:S.overtimeHours,projectName:S.projectName,description:S.description};let r;if(se.value?r=await wa({...e,id:S.id}):r=await va(e),r.code===200&&r.success)s.success(se.value?"加班记录修改成功":"加班记录添加成功"),ne.value=!1,await Me(),S.id=0,S.reportDate="",S.overtimeHours=0,S.projectName="",S.description="";else{let i=r.message;i.includes("Duplicate entry")&&i.includes("unique_report")&&(i="该日期的加班记录已存在，请修改或删除原记录后重新添加"),s.error((se.value?"加班记录修改失败：":"加班记录添加失败：")+i)}}catch(t){console.error("保存加班记录失败：",t),s.error("保存加班记录失败")}},It=t=>{X.confirm("确定要删除这条加班记录吗？","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const e=C();if(!e){s.error("请先登录");return}const r=await ha(t,e.id);r.code===200&&r.success?(ie.value=ie.value.filter(i=>i.id!==t),E.total--,s.success("加班记录删除成功")):s.error("加班记录删除失败："+r.message)}catch(e){console.error("删除加班记录失败：",e),s.error("删除加班记录失败")}}).catch(()=>{})},Nt=()=>{if(H.value.length===0){s.warning("请选择要删除的加班记录");return}X.confirm(`确定要删除选中的 ${H.value.length} 条加班记录吗？`,"批量删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const t=C();if(!t){s.error("请先登录");return}const e=await Da(H.value,t.id);e.code===200&&e.success?(ie.value=ie.value.filter(r=>!H.value.includes(r.id)),E.total-=H.value.length,H.value=[],We.value=[],s.success("批量删除成功")):s.error("批量删除失败："+e.message)}catch(t){console.error("批量删除加班记录失败：",t),s.error("批量删除加班记录失败")}}).catch(()=>{})},Wt=t=>{E.pageSize=t,Me()},Ht=t=>{E.current=t,Me()},Oe=()=>{const t=new Date,e=t.getFullYear(),r=t.getMonth();let i,c;t.getDate()>=26?(i=new Date(e,r,26),c=new Date(e,r+1,25)):(i=new Date(e,r-1,26),c=new Date(e,r,25));const h=D=>{const k=D.getFullYear(),u=String(D.getMonth()+1).padStart(2,"0"),R=String(D.getDate()).padStart(2,"0");return`${k}-${u}-${R}`};return{startDate:h(i),endDate:h(c)}},Tt=()=>{const t=new Date,e=t.getDay()||7,r=new Date(t);r.setDate(t.getDate()-e+1);const i=new Date(r);i.setDate(r.getDate()+6);const c=h=>{const D=h.getFullYear(),k=String(h.getMonth()+1).padStart(2,"0"),u=String(h.getDate()).padStart(2,"0");return`${D}-${k}-${u}`};return{startDate:c(r),endDate:c(i)}},fe=async(t,e)=>{try{Qe.value=!0;const r=C();if(!r){s.error("请先登录");return}const i=await ot(r.id,t,e);if(i.code===200&&i.success){const c=i.data,h=c.reduce(($,F)=>$+parseFloat(F.performanceManDays.toString()),0),k=new Set(c.map($=>$.date)).size;let u=h-k;const R=await lt(r.id,t,e);if(R.code===200&&R.success){const p=R.data.reduce((v,O)=>v+parseFloat(O.overtimeHours?.toString()||"0"),0)/8;u-=p}const P=k>0?u/k:0;me.totalPerformance=u.toFixed(5),me.attendanceDays=k,me.avgPerformance=P.toFixed(5),Qt(c,t,e)}else s.error("获取绩效数据失败："+i.message)}catch(r){console.error("获取绩效数据失败：",r),s.error("获取绩效数据失败")}finally{Qe.value=!1}},Lt=()=>{if(Be.value){he=oa(Be.value);const t={tooltip:{trigger:"axis",formatter:function(e){return e[0].name+"<br/>绩效人天："+e[0].value.toFixed(5)}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value",axisLabel:{formatter:"{value}"}},series:[{name:"绩效人天",type:"line",smooth:!0,data:[],itemStyle:{color:"#667eea"},areaStyle:{color:new ra(0,0,0,1,[{offset:0,color:"rgba(102, 126, 234, 0.5)"},{offset:1,color:"rgba(102, 126, 234, 0.1)"}])}}]};he.setOption(t),window.addEventListener("resize",()=>{he?.resize()})}},Qt=(t,e,r)=>{if(!he)return;const i=[],c=new Date(e),h=new Date(r);for(let u=new Date(c);u<=h;u.setDate(u.getDate()+1))i.push(u.toISOString().split("T")[0]);const D=new Map;t.forEach(u=>{const R=u.date,P=parseFloat(u.performanceManDays.toString());D.has(R)?D.set(R,D.get(R)+P):D.set(R,P)});const k=i.map(u=>D.get(u)||0);he.setOption({xAxis:{data:i},yAxis:{type:"value",axisLabel:{formatter:"{value}"},axisLine:{show:!0},splitLine:{show:!0}},series:[{data:k,markLine:{silent:!0,data:[{yAxis:1,label:{formatter:"定额",position:"end"},lineStyle:{color:"#ff4d4f",width:1,type:"dashed"}}]}}]})},Kt=()=>{if(I.value==="week"){const t=Tt();fe(t.startDate,t.endDate)}else if(I.value==="month"){const t=Oe();fe(t.startDate,t.endDate)}else if(I.value==="month_select"){Jt();const e=Oe().startDate.substring(0,7);we.value=e,et()}else I.value==="custom"&&Q.value.length===2&&fe(Q.value[0],Q.value[1])},Jt=()=>{const t=[],e=new Date;for(let r=11;r>=0;r--){const i=new Date(e.getFullYear(),e.getMonth()-r,1),c=i.getFullYear(),h=i.getMonth()+1,D=`${c}-${h.toString().padStart(2,"0")}`,k=`${c}年${h}月`;t.push({value:D,label:k})}Le.value=t},et=()=>{if(!we.value)return;const[t,e]=we.value.split("-"),r=Number(t)||0,i=Number(e)||1;let c,h;c=new Date(r,i-1,26),h=new Date(r,i,25);const D=k=>{const u=k.getFullYear(),R=String(k.getMonth()+1).padStart(2,"0"),P=String(k.getDate()).padStart(2,"0");return`${u}-${R}-${P}`};fe(D(c),D(h))},Gt=()=>{I.value==="custom"&&Q.value.length===2&&fe(Q.value[0],Q.value[1])},tt=t=>{if(!t)return"";const e=new Date(t),r=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),c=String(e.getDate()).padStart(2,"0");return`${r}-${i}-${c}`},Xt=t=>{if(!t)return"";const e=new Date(t),r=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),c=String(e.getDate()).padStart(2,"0"),h=String(e.getHours()).padStart(2,"0"),D=String(e.getMinutes()).padStart(2,"0"),k=String(e.getSeconds()).padStart(2,"0");return`${r}-${i}-${c} ${h}:${D}:${k}`};return ea(()=>{st(),ta(()=>{Lt();const t=Oe();fe(t.startDate,t.endDate)})}),(t,e)=>{const r=U("el-button"),i=U("el-radio"),c=U("el-radio-group"),h=U("el-option"),D=U("el-select"),k=U("el-date-picker"),u=U("el-table-column"),R=U("el-tag"),P=U("el-table"),$=U("el-pagination"),F=U("el-input"),p=U("el-form-item"),v=U("el-input-number"),O=U("el-form"),_=U("el-dialog"),ge=aa("loading");return B(),ye("div",Sa,[g("div",Va,[e[83]||(e[83]=g("h2",null,"绩效记录",-1)),g("div",ka,[a(r,{type:"primary",onClick:e[0]||(e[0]=o=>x.value=!0)},{default:l(()=>[...e[79]||(e[79]=[m(" 工作汇报 ",-1)])]),_:1}),a(r,{type:"primary",onClick:e[1]||(e[1]=o=>Ve.value=!0)},{default:l(()=>[...e[80]||(e[80]=[m(" 加班汇报 ",-1)])]),_:1}),a(r,{type:"primary",onClick:e[2]||(e[2]=o=>re.value=!0)},{default:l(()=>[...e[81]||(e[81]=[m(" 工资记录 ",-1)])]),_:1}),a(r,{type:"primary",onClick:e[3]||(e[3]=o=>w.value=!0)},{default:l(()=>[...e[82]||(e[82]=[m(" 生产项目配置 ",-1)])]),_:1})])]),g("div",Ca,[g("div",Ra,[a(c,{modelValue:I.value,"onUpdate:modelValue":e[4]||(e[4]=o=>I.value=o),onChange:Kt},{default:l(()=>[a(i,{label:"week"},{default:l(()=>[...e[84]||(e[84]=[m("本周",-1)])]),_:1}),a(i,{label:"month"},{default:l(()=>[...e[85]||(e[85]=[m("本月",-1)])]),_:1}),a(i,{label:"month_select"},{default:l(()=>[...e[86]||(e[86]=[m("选择月份",-1)])]),_:1}),a(i,{label:"custom"},{default:l(()=>[...e[87]||(e[87]=[m("自定义",-1)])]),_:1})]),_:1},8,["modelValue"]),I.value==="month_select"?(B(),ye("div",ja,[a(D,{modelValue:we.value,"onUpdate:modelValue":e[5]||(e[5]=o=>we.value=o),placeholder:"请选择月份",style:{width:"200px"},onChange:et},{default:l(()=>[(B(!0),ye(Ie,null,Ne(Le.value,o=>(B(),oe(h,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])):ve("",!0),I.value==="custom"?(B(),ye("div",Ma,[a(k,{modelValue:Q.value,"onUpdate:modelValue":e[6]||(e[6]=o=>Q.value=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:Gt},null,8,["modelValue"])])):ve("",!0)]),g("div",xa,[g("div",Pa,[e[88]||(e[88]=g("div",{class:"performance-label"},"当月绩效总和",-1)),g("div",Ua,J(me.totalPerformance),1),e[89]||(e[89]=g("div",{class:"performance-desc"},"绩效人天合计",-1))]),g("div",za,[e[90]||(e[90]=g("div",{class:"performance-label"},"当月考勤天数",-1)),g("div",Ea,J(me.attendanceDays),1),e[91]||(e[91]=g("div",{class:"performance-desc"},"当月出勤天数",-1))]),g("div",Aa,[e[92]||(e[92]=g("div",{class:"performance-label"},"日均绩效",-1)),g("div",Ya,J(me.avgPerformance),1),e[93]||(e[93]=g("div",{class:"performance-desc"},"平均绩效人天",-1))])]),g("div",qa,[e[94]||(e[94]=g("h3",null,"绩效趋势",-1)),g("div",{id:"performanceChart",ref_key:"performanceChartRef",ref:Be,class:"chart"},null,512)])]),a(_,{modelValue:w.value,"onUpdate:modelValue":e[16]||(e[16]=o=>w.value=o),title:"生产项目配置",width:"90%","max-width":"1200px"},{default:l(()=>[g("div",$a,[a(r,{type:"primary",onClick:mt},{icon:l(()=>[a(M(Pe))]),default:l(()=>[e[95]||(e[95]=m(" 添加项目 ",-1))]),_:1}),a(r,{type:"danger",disabled:K.value.length===0,onClick:vt},{icon:l(()=>[a(M(G))]),default:l(()=>[e[96]||(e[96]=m(" 批量删除 ",-1))]),_:1},8,["disabled"])]),Ue((B(),oe(P,{data:N.value,style:{width:"100%"},onSelectionChange:ct},{default:l(()=>[a(u,{type:"selection","min-width":"55"}),ve("",!0),a(u,{prop:"projectCode",label:"项目编码","min-width":"120"}),a(u,{prop:"projectName",label:"项目名称","min-width":"150"}),a(u,{prop:"workQuotaEfficiency",label:"作业工序额定效率","min-width":"140"}),a(u,{prop:"inspectQuotaEfficiency",label:"质检工序额定效率","min-width":"140"}),a(u,{prop:"status",label:"状态","min-width":"80"},{default:l(o=>[a(R,{type:o.row.status===1?"success":"danger"},{default:l(()=>[m(J(o.row.status===1?"启用":"停用"),1)]),_:2},1032,["type"])]),_:1}),a(u,{label:"操作","min-width":"180"},{default:l(o=>[a(r,{type:"primary",size:"small",onClick:W=>ft(o.row)},{icon:l(()=>[a(M(ze))]),default:l(()=>[e[97]||(e[97]=m(" 修改 ",-1))]),_:1},8,["onClick"]),a(r,{type:"danger",size:"small",onClick:W=>yt(o.row.id)},{icon:l(()=>[a(M(G))]),default:l(()=>[e[98]||(e[98]=m(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ge,Ye.value]]),g("div",Ba,[a($,{"current-page":q.current,"onUpdate:currentPage":e[7]||(e[7]=o=>q.current=o),"page-size":q.pageSize,"onUpdate:pageSize":e[8]||(e[8]=o=>q.pageSize=o),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:q.total,onSizeChange:bt,onCurrentChange:wt},null,8,["current-page","page-size","total"])]),a(_,{modelValue:de.value,"onUpdate:modelValue":e[15]||(e[15]=o=>de.value=o),title:ke.value?"修改项目":"添加项目",width:"500px"},{footer:l(()=>[g("span",_a,[a(r,{onClick:e[14]||(e[14]=o=>de.value=!1)},{default:l(()=>[...e[101]||(e[101]=[m("取消",-1)])]),_:1}),a(r,{type:"primary",onClick:gt},{default:l(()=>[...e[102]||(e[102]=[m("确定",-1)])]),_:1})])]),default:l(()=>[a(O,{ref_key:"projectFormRef",ref:_e,model:V,rules:pt,"label-width":"150px"},{default:l(()=>[a(p,{label:"项目编码",prop:"projectCode"},{default:l(()=>[a(F,{modelValue:V.projectCode,"onUpdate:modelValue":e[9]||(e[9]=o=>V.projectCode=o),placeholder:"请输入项目编码"},null,8,["modelValue"])]),_:1}),a(p,{label:"项目名称",prop:"projectName"},{default:l(()=>[a(F,{modelValue:V.projectName,"onUpdate:modelValue":e[10]||(e[10]=o=>V.projectName=o),placeholder:"请输入项目名称"},null,8,["modelValue"])]),_:1}),a(p,{label:"作业工序额定效率",prop:"workQuotaEfficiency"},{default:l(()=>[a(v,{modelValue:V.workQuotaEfficiency,"onUpdate:modelValue":e[11]||(e[11]=o=>V.workQuotaEfficiency=o),min:0,placeholder:"请输入作业工序额定效率"},null,8,["modelValue"])]),_:1}),a(p,{label:"质检工序额定效率",prop:"inspectQuotaEfficiency"},{default:l(()=>[a(v,{modelValue:V.inspectQuotaEfficiency,"onUpdate:modelValue":e[12]||(e[12]=o=>V.inspectQuotaEfficiency=o),min:0,placeholder:"请输入质检工序额定效率"},null,8,["modelValue"])]),_:1}),a(p,{label:"状态",prop:"status"},{default:l(()=>[a(c,{modelValue:V.status,"onUpdate:modelValue":e[13]||(e[13]=o=>V.status=o)},{default:l(()=>[a(i,{label:1},{default:l(()=>[...e[99]||(e[99]=[m("启用",-1)])]),_:1}),a(i,{label:0},{default:l(()=>[...e[100]||(e[100]=[m("停用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])]),_:1},8,["modelValue"]),a(_,{modelValue:x.value,"onUpdate:modelValue":e[27]||(e[27]=o=>x.value=o),title:"工作汇报",width:"90%","max-width":"1000px"},{default:l(()=>[g("div",Fa,[a(r,{type:"primary",onClick:Vt},{icon:l(()=>[a(M(Pe))]),default:l(()=>[e[103]||(e[103]=m(" 添加绩效记录 ",-1))]),_:1}),a(r,{type:"danger",disabled:ee.value.length===0,onClick:Rt},{icon:l(()=>[a(M(G))]),default:l(()=>[e[104]||(e[104]=m(" 批量删除 ",-1))]),_:1},8,["disabled"])]),Ue((B(),oe(P,{data:ce.value,style:{width:"100%"},onSelectionChange:St},{default:l(()=>[a(u,{type:"selection",width:"55"}),ve("",!0),a(u,{prop:"date",label:"绩效日期","min-width":"120"}),a(u,{prop:"project",label:"生产项目","min-width":"150"}),a(u,{prop:"process",label:"工序","min-width":"80"}),a(u,{prop:"quotaEfficiency",label:"额定效率","min-width":"100"}),a(u,{prop:"actualWorkload",label:"实际工作量","min-width":"120"}),a(u,{prop:"performanceManDays",label:"绩效人天合计","min-width":"140"}),a(u,{label:"操作","min-width":"150"},{default:l(o=>[a(r,{type:"primary",size:"small",onClick:W=>kt(o.row)},{icon:l(()=>[a(M(ze))]),default:l(()=>[e[105]||(e[105]=m(" 修改 ",-1))]),_:1},8,["onClick"]),a(r,{type:"danger",size:"small",onClick:W=>Ct(o.row.id)},{icon:l(()=>[a(M(G))]),default:l(()=>[e[106]||(e[106]=m(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ge,qe.value]]),g("div",Oa,[a($,{"current-page":A.current,"onUpdate:currentPage":e[17]||(e[17]=o=>A.current=o),"page-size":A.pageSize,"onUpdate:pageSize":e[18]||(e[18]=o=>A.pageSize=o),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:A.total,onSizeChange:jt,onCurrentChange:Mt},null,8,["current-page","page-size","total"])]),a(_,{modelValue:ue.value,"onUpdate:modelValue":e[26]||(e[26]=o=>ue.value=o),title:Ae.value?"修改绩效记录":"添加绩效记录",width:"600px"},{footer:l(()=>[g("span",Ia,[a(r,{onClick:e[25]||(e[25]=o=>ue.value=!1)},{default:l(()=>[...e[107]||(e[107]=[m("取消",-1)])]),_:1}),a(r,{type:"primary",onClick:Dt},{default:l(()=>[...e[108]||(e[108]=[m("保存",-1)])]),_:1})])]),default:l(()=>[a(O,{ref_key:"workReportFormRef",ref:ae,model:d,rules:dt,"label-width":"120px"},{default:l(()=>[a(p,{label:"绩效日期",prop:"date"},{default:l(()=>[a(k,{modelValue:d.date,"onUpdate:modelValue":e[19]||(e[19]=o=>d.date=o),type:"date",placeholder:"请选择绩效日期",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",required:""},null,8,["modelValue"])]),_:1}),a(p,{label:"生产项目",prop:"project"},{default:l(()=>[a(D,{modelValue:d.project,"onUpdate:modelValue":e[20]||(e[20]=o=>d.project=o),placeholder:"请选择生产项目",style:{width:"100%"},required:"",onChange:ht},{default:l(()=>[(B(!0),ye(Ie,null,Ne(pe.value,o=>(B(),oe(h,{key:o.id,label:o.projectName,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"工序",prop:"process"},{default:l(()=>[a(D,{modelValue:d.process,"onUpdate:modelValue":e[21]||(e[21]=o=>d.process=o),placeholder:"请选择工序",style:{width:"100%"},required:"",onChange:Je},{default:l(()=>[a(h,{label:"作业",value:"作业"}),a(h,{label:"质检",value:"质检"})]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"额定效率",prop:"quotaEfficiency"},{default:l(()=>[a(v,{modelValue:d.quotaEfficiency,"onUpdate:modelValue":e[22]||(e[22]=o=>d.quotaEfficiency=o),min:1,placeholder:"额定效率",style:{width:"100%"},disabled:!0},null,8,["modelValue"])]),_:1}),a(p,{label:"实际工作量",prop:"actualWorkload"},{default:l(()=>[a(v,{modelValue:d.actualWorkload,"onUpdate:modelValue":e[23]||(e[23]=o=>d.actualWorkload=o),min:1,placeholder:"请输入实际工作量",style:{width:"100%"},onChange:Ge},null,8,["modelValue"])]),_:1}),a(p,{label:"绩效人天合计",prop:"performanceManDays"},{default:l(()=>[a(F,{modelValue:d.performanceManDays,"onUpdate:modelValue":e[24]||(e[24]=o=>d.performanceManDays=o),placeholder:"绩效人天合计",style:{width:"100%"},disabled:!0},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])]),_:1},8,["modelValue"]),a(_,{modelValue:re.value,"onUpdate:modelValue":e[69]||(e[69]=o=>re.value=o),title:"工资记录",width:"90%","max-width":"1200px"},{default:l(()=>[g("div",Na,[a(r,{type:"primary",onClick:Ut},{icon:l(()=>[a(M(Pe))]),default:l(()=>[e[109]||(e[109]=m(" 添加工资记录 ",-1))]),_:1}),a(r,{type:"danger",disabled:L.value.length===0,onClick:Yt},{icon:l(()=>[a(M(G))]),default:l(()=>[e[110]||(e[110]=m(" 批量删除 ",-1))]),_:1},8,["disabled"])]),Ue((B(),oe(P,{data:T.value,style:{width:"100%"},onSelectionChange:xt},{default:l(()=>[a(u,{type:"selection",width:"55"}),ve("",!0),a(u,{prop:"yearMonth",label:"年月","min-width":"100"}),a(u,{prop:"periodStart",label:"周期开始","min-width":"120"},{default:l(o=>[m(J(tt(o.row.periodStart)),1)]),_:1}),a(u,{prop:"periodEnd",label:"周期结束","min-width":"120"},{default:l(o=>[m(J(tt(o.row.periodEnd)),1)]),_:1}),a(u,{prop:"attendanceDays",label:"出勤天数","min-width":"100"}),a(u,{prop:"baseSalary",label:"基本薪资","min-width":"120"}),a(u,{prop:"performance",label:"绩效系数","min-width":"100"}),a(u,{prop:"performanceSalary",label:"绩效薪资","min-width":"120"}),a(u,{prop:"totalIncome",label:"应发总额","min-width":"120"}),a(u,{prop:"totalDeduction",label:"扣除总额","min-width":"120"}),a(u,{prop:"netSalary",label:"实发薪资","min-width":"120"}),a(u,{label:"操作","min-width":"150"},{default:l(o=>[a(r,{type:"primary",size:"small",onClick:W=>zt(o.row)},{icon:l(()=>[a(M(ze))]),default:l(()=>[e[111]||(e[111]=m(" 修改 ",-1))]),_:1},8,["onClick"]),a(r,{type:"danger",size:"small",onClick:W=>At(o.row.id)},{icon:l(()=>[a(M(G))]),default:l(()=>[e[112]||(e[112]=m(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ge,$e.value]]),g("div",Wa,[a($,{"current-page":Y.current,"onUpdate:currentPage":e[28]||(e[28]=o=>Y.current=o),"page-size":Y.pageSize,"onUpdate:pageSize":e[29]||(e[29]=o=>Y.pageSize=o),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:Y.total,onSizeChange:qt,onCurrentChange:$t},null,8,["current-page","page-size","total"])]),a(_,{modelValue:le.value,"onUpdate:modelValue":e[55]||(e[55]=o=>le.value=o),title:Se.value?"修改工资记录":"添加工资记录",width:"800px"},{footer:l(()=>[g("span",Qa,[a(r,{onClick:e[53]||(e[53]=o=>be.value=!0)},{default:l(()=>[...e[113]||(e[113]=[m("默认配置",-1)])]),_:1}),a(r,{onClick:e[54]||(e[54]=o=>le.value=!1)},{default:l(()=>[...e[114]||(e[114]=[m("取消",-1)])]),_:1}),a(r,{type:"primary",onClick:Et},{default:l(()=>[...e[115]||(e[115]=[m("保存",-1)])]),_:1})])]),default:l(()=>[a(O,{ref_key:"salaryRecordFormRef",ref:te,model:n,rules:ut,"label-width":"120px"},{default:l(()=>[g("div",Ha,[g("div",Ta,[a(p,{label:"年月",prop:"yearMonth"},{default:l(()=>[a(k,{modelValue:n.yearMonth,"onUpdate:modelValue":e[30]||(e[30]=o=>n.yearMonth=o),type:"month",placeholder:"请选择年月",style:{width:"100%"},format:"YYYY-MM","value-format":"YYYY-MM",required:"",onChange:Pt},null,8,["modelValue"])]),_:1}),a(p,{label:"周期开始日期",prop:"periodStart"},{default:l(()=>[a(k,{modelValue:n.periodStart,"onUpdate:modelValue":e[31]||(e[31]=o=>n.periodStart=o),type:"date",placeholder:"请选择周期开始日期",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",required:"",disabled:""},null,8,["modelValue"])]),_:1}),a(p,{label:"周期结束日期",prop:"periodEnd"},{default:l(()=>[a(k,{modelValue:n.periodEnd,"onUpdate:modelValue":e[32]||(e[32]=o=>n.periodEnd=o),type:"date",placeholder:"请选择周期结束日期",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",required:"",disabled:""},null,8,["modelValue"])]),_:1}),a(p,{label:"出勤天数",prop:"attendanceDays"},{default:l(()=>[a(v,{modelValue:n.attendanceDays,"onUpdate:modelValue":e[33]||(e[33]=o=>n.attendanceDays=o),min:0,placeholder:"请输入出勤天数",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"基本薪资",prop:"baseSalary"},{default:l(()=>[a(v,{modelValue:n.baseSalary,"onUpdate:modelValue":e[34]||(e[34]=o=>n.baseSalary=o),min:0,step:.01,placeholder:"请输入基本薪资",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"绩效系数/评分",prop:"performance"},{default:l(()=>[a(v,{modelValue:n.performance,"onUpdate:modelValue":e[35]||(e[35]=o=>n.performance=o),min:0,step:.01,placeholder:"请输入绩效系数/评分",style:{width:"100%"},onChange:e[36]||(e[36]=()=>{Xe(),De()})},null,8,["modelValue"])]),_:1}),a(p,{label:"绩效薪资",prop:"performanceSalary"},{default:l(()=>[a(v,{modelValue:n.performanceSalary,"onUpdate:modelValue":e[37]||(e[37]=o=>n.performanceSalary=o),min:0,step:.01,placeholder:"请输入绩效薪资",style:{width:"100%"},disabled:""},null,8,["modelValue"])]),_:1}),a(p,{label:"岗位绩效",prop:"positionPerformance"},{default:l(()=>[a(v,{modelValue:n.positionPerformance,"onUpdate:modelValue":e[38]||(e[38]=o=>n.positionPerformance=o),min:0,step:.01,placeholder:"请输入岗位绩效",style:{width:"100%"},onChange:De},null,8,["modelValue"])]),_:1}),a(p,{label:"餐补",prop:"mealAllowance"},{default:l(()=>[a(v,{modelValue:n.mealAllowance,"onUpdate:modelValue":e[39]||(e[39]=o=>n.mealAllowance=o),min:0,step:.01,placeholder:"请输入餐补",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"房补",prop:"housingAllowance"},{default:l(()=>[a(v,{modelValue:n.housingAllowance,"onUpdate:modelValue":e[40]||(e[40]=o=>n.housingAllowance=o),min:0,step:.01,placeholder:"请输入房补",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"全勤奖",prop:"fullAttendance"},{default:l(()=>[a(v,{modelValue:n.fullAttendance,"onUpdate:modelValue":e[41]||(e[41]=o=>n.fullAttendance=o),min:0,step:.01,placeholder:"请输入全勤奖",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),g("div",La,[a(p,{label:"其他奖金",prop:"otherBonus"},{default:l(()=>[a(v,{modelValue:n.otherBonus,"onUpdate:modelValue":e[42]||(e[42]=o=>n.otherBonus=o),min:0,step:.01,placeholder:"请输入其他奖金",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"养老保险",prop:"pension"},{default:l(()=>[a(v,{modelValue:n.pension,"onUpdate:modelValue":e[43]||(e[43]=o=>n.pension=o),min:0,step:.01,placeholder:"请输入养老保险",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"医疗保险",prop:"medical"},{default:l(()=>[a(v,{modelValue:n.medical,"onUpdate:modelValue":e[44]||(e[44]=o=>n.medical=o),min:0,step:.01,placeholder:"请输入医疗保险",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"失业保险",prop:"unemployment"},{default:l(()=>[a(v,{modelValue:n.unemployment,"onUpdate:modelValue":e[45]||(e[45]=o=>n.unemployment=o),min:0,step:.01,placeholder:"请输入失业保险",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"迟到分钟",prop:"lateDeduction"},{default:l(()=>[a(v,{modelValue:n.lateDeduction,"onUpdate:modelValue":e[46]||(e[46]=o=>n.lateDeduction=o),min:0,step:1,placeholder:"请输入迟到分钟",style:{width:"100%"},onChange:De},null,8,["modelValue"])]),_:1}),a(p,{label:"加班时长(小时)",prop:"overtimeHours"},{default:l(()=>[a(v,{modelValue:n.overtimeHours,"onUpdate:modelValue":e[47]||(e[47]=o=>n.overtimeHours=o),min:0,step:.5,placeholder:"请输入加班时长",style:{width:"100%"},onChange:e[48]||(e[48]=()=>{Ze(),De()})},null,8,["modelValue"])]),_:1}),a(p,{label:"加班薪资",prop:"overtimeSalary"},{default:l(()=>[a(v,{modelValue:n.overtimeSalary,"onUpdate:modelValue":e[49]||(e[49]=o=>n.overtimeSalary=o),min:0,step:.01,placeholder:"请输入加班薪资",style:{width:"100%"},disabled:""},null,8,["modelValue"])]),_:1}),a(p,{label:"应发总额",prop:"totalIncome"},{default:l(()=>[a(v,{modelValue:n.totalIncome,"onUpdate:modelValue":e[50]||(e[50]=o=>n.totalIncome=o),min:0,step:.01,placeholder:"请输入应发总额",style:{width:"100%"},disabled:""},null,8,["modelValue"])]),_:1}),a(p,{label:"扣除总额",prop:"totalDeduction"},{default:l(()=>[a(v,{modelValue:n.totalDeduction,"onUpdate:modelValue":e[51]||(e[51]=o=>n.totalDeduction=o),min:0,step:.01,placeholder:"请输入扣除总额",style:{width:"100%"},disabled:""},null,8,["modelValue"])]),_:1}),a(p,{label:"实发薪资",prop:"netSalary"},{default:l(()=>[a(v,{modelValue:n.netSalary,"onUpdate:modelValue":e[52]||(e[52]=o=>n.netSalary=o),min:0,step:.01,placeholder:"请输入实发薪资",style:{width:"100%"},disabled:""},null,8,["modelValue"])]),_:1})])])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),a(_,{modelValue:be.value,"onUpdate:modelValue":e[68]||(e[68]=o=>be.value=o),title:"薪资记录默认配置",width:"600px"},{footer:l(()=>[g("span",Xa,[a(r,{onClick:e[67]||(e[67]=o=>be.value=!1)},{default:l(()=>[...e[116]||(e[116]=[m("取消",-1)])]),_:1}),a(r,{type:"primary",onClick:it},{default:l(()=>[...e[117]||(e[117]=[m("保存",-1)])]),_:1})])]),default:l(()=>[a(O,{model:b,"label-width":"120px"},{default:l(()=>[g("div",Ka,[g("div",Ja,[a(p,{label:"出勤天数"},{default:l(()=>[a(v,{modelValue:b.attendanceDays,"onUpdate:modelValue":e[56]||(e[56]=o=>b.attendanceDays=o),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"基本薪资"},{default:l(()=>[a(v,{modelValue:b.baseSalary,"onUpdate:modelValue":e[57]||(e[57]=o=>b.baseSalary=o),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"绩效系数/评分"},{default:l(()=>[a(v,{modelValue:b.performance,"onUpdate:modelValue":e[58]||(e[58]=o=>b.performance=o),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"岗位绩效"},{default:l(()=>[a(v,{modelValue:b.positionPerformance,"onUpdate:modelValue":e[59]||(e[59]=o=>b.positionPerformance=o),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"餐补"},{default:l(()=>[a(v,{modelValue:b.mealAllowance,"onUpdate:modelValue":e[60]||(e[60]=o=>b.mealAllowance=o),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),g("div",Ga,[a(p,{label:"房补"},{default:l(()=>[a(v,{modelValue:b.housingAllowance,"onUpdate:modelValue":e[61]||(e[61]=o=>b.housingAllowance=o),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"全勤奖"},{default:l(()=>[a(v,{modelValue:b.fullAttendance,"onUpdate:modelValue":e[62]||(e[62]=o=>b.fullAttendance=o),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"其他奖金"},{default:l(()=>[a(v,{modelValue:b.otherBonus,"onUpdate:modelValue":e[63]||(e[63]=o=>b.otherBonus=o),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"养老保险"},{default:l(()=>[a(v,{modelValue:b.pension,"onUpdate:modelValue":e[64]||(e[64]=o=>b.pension=o),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"医疗保险"},{default:l(()=>[a(v,{modelValue:b.medical,"onUpdate:modelValue":e[65]||(e[65]=o=>b.medical=o),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(p,{label:"失业保险"},{default:l(()=>[a(v,{modelValue:b.unemployment,"onUpdate:modelValue":e[66]||(e[66]=o=>b.unemployment=o),min:0,step:.01,style:{width:"100%"}},null,8,["modelValue"])]),_:1})])])]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),a(_,{modelValue:Ve.value,"onUpdate:modelValue":e[78]||(e[78]=o=>Ve.value=o),title:"加班汇报",width:"90%","max-width":"1000px"},{default:l(()=>[g("div",Za,[a(r,{type:"primary",onClick:_t},{icon:l(()=>[a(M(Pe))]),default:l(()=>[e[118]||(e[118]=m(" 添加加班记录 ",-1))]),_:1}),a(r,{type:"danger",disabled:H.value.length===0,onClick:Nt},{icon:l(()=>[a(M(G))]),default:l(()=>[e[119]||(e[119]=m(" 批量删除 ",-1))]),_:1},8,["disabled"])]),Ue((B(),oe(P,{data:ie.value,style:{width:"100%"},onSelectionChange:Bt},{default:l(()=>[a(u,{type:"selection",width:"55"}),ve("",!0),a(u,{prop:"reportDate",label:"汇报日期","min-width":"120"}),a(u,{prop:"overtimeHours",label:"加班小时数","min-width":"120"}),a(u,{prop:"projectName",label:"项目名称","min-width":"150"}),a(u,{prop:"description",label:"加班描述","min-width":"200"}),a(u,{prop:"status",label:"状态","min-width":"100"},{default:l(o=>[a(R,{type:o.row.status==="pending"?"warning":o.row.status==="approved"?"success":"danger"},{default:l(()=>[m(J(o.row.status==="pending"?"待审批":o.row.status==="approved"?"已通过":"已拒绝"),1)]),_:2},1032,["type"])]),_:1}),a(u,{prop:"createdAt",label:"创建时间","min-width":"180"},{default:l(o=>[m(J(Xt(o.row.createdAt)),1)]),_:1}),a(u,{label:"操作","min-width":"150"},{default:l(o=>[a(r,{type:"primary",size:"small",onClick:W=>Ft(o.row)},{icon:l(()=>[a(M(ze))]),default:l(()=>[e[120]||(e[120]=m(" 修改 ",-1))]),_:1},8,["onClick"]),a(r,{type:"danger",size:"small",onClick:W=>It(o.row.id)},{icon:l(()=>[a(M(G))]),default:l(()=>[e[121]||(e[121]=m(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ge,Ee.value]]),g("div",eo,[a($,{"current-page":E.current,"onUpdate:currentPage":e[70]||(e[70]=o=>E.current=o),"page-size":E.pageSize,"onUpdate:pageSize":e[71]||(e[71]=o=>E.pageSize=o),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:E.total,onSizeChange:Wt,onCurrentChange:Ht},null,8,["current-page","page-size","total"])]),a(_,{modelValue:ne.value,"onUpdate:modelValue":e[77]||(e[77]=o=>ne.value=o),title:se.value?"修改加班记录":"添加加班记录",width:"600px"},{footer:l(()=>[g("span",to,[a(r,{onClick:e[76]||(e[76]=o=>ne.value=!1)},{default:l(()=>[...e[122]||(e[122]=[m("取消",-1)])]),_:1}),a(r,{type:"primary",onClick:Ot},{default:l(()=>[...e[123]||(e[123]=[m("保存",-1)])]),_:1})])]),default:l(()=>[a(O,{ref_key:"overtimeReportFormRef",ref:Z,model:S,rules:nt,"label-width":"120px"},{default:l(()=>[a(p,{label:"汇报日期",prop:"reportDate"},{default:l(()=>[a(k,{modelValue:S.reportDate,"onUpdate:modelValue":e[72]||(e[72]=o=>S.reportDate=o),type:"date",placeholder:"请选择汇报日期",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",required:""},null,8,["modelValue"])]),_:1}),a(p,{label:"加班小时数",prop:"overtimeHours"},{default:l(()=>[a(v,{modelValue:S.overtimeHours,"onUpdate:modelValue":e[73]||(e[73]=o=>S.overtimeHours=o),min:.5,step:.5,placeholder:"请输入加班小时数",style:{width:"100%"},required:""},null,8,["modelValue"])]),_:1}),a(p,{label:"项目名称",prop:"projectName"},{default:l(()=>[a(D,{modelValue:S.projectName,"onUpdate:modelValue":e[74]||(e[74]=o=>S.projectName=o),placeholder:"请选择项目名称（可选）",style:{width:"100%"}},{default:l(()=>[(B(!0),ye(Ie,null,Ne(pe.value,o=>(B(),oe(h,{key:o.id,label:o.projectName,value:o.projectName},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"加班描述",prop:"description"},{default:l(()=>[a(F,{modelValue:S.description,"onUpdate:modelValue":e[75]||(e[75]=o=>S.description=o),type:"textarea",placeholder:"请输入加班描述（可选）",rows:"4",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])]),_:1},8,["modelValue"])])}}}),io=la(ao,[["__scopeId","data-v-5fdd4ebd"]]);export{io as default};
