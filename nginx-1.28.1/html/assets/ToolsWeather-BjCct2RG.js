import{d as W,k as q,c as r,a as e,b as n,w as d,D as a,C as V,H as w,I as k,h as v,E as p,r as i,o,e as M,t as $,g as z,z as x}from"./index-CryXMyaq.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"weather-container"},H={class:"weather-card"},L={class:"card-header"},Q={class:"weather-content"},R={key:0,class:"loading-state"},S={key:1,class:"weather-result"},G={class:"weather-overview-card"},J={class:"weather-overview"},K={class:"update-time"},O={key:0,class:"current-weather"},X={class:"weather-type"},Y={class:"weather-temp"},Z={class:"weather-info"},ee={class:"weather-forecast-card"},te={key:0,class:"forecast-list"},ae={class:"forecast-date"},se={class:"forecast-week"},le={class:"forecast-type"},oe={class:"forecast-temp"},ne={class:"forecast-info"},re={class:"forecast-notice"},ce={key:2,class:"weather-empty"},de=W({__name:"ToolsWeather",setup(ie){const g=v([]),y=v([]),h=v(null),_=v(null),s=v(null),f=v(!1),N=async()=>{try{const l=await(await fetch("/api/cities/provinces")).json();g.value=l}catch(c){p.error("获取省份列表失败"),console.error("获取省份列表失败:",c)}},B=async c=>{try{const u=await(await fetch(`/api/cities/cities/${c}`)).json();y.value=u}catch(l){p.error("获取城市列表失败"),console.error("获取城市列表失败:",l)}},I=()=>{_.value=null,y.value=[],h.value&&B(h.value.id)},j=async()=>{if(!_.value){p.warning("请选择城市");return}f.value=!0,s.value=null;try{const c=_.value.name,u=await(await fetch(`/api/weather?cityName=${encodeURIComponent(c)}`)).json();u.code===0?s.value=u:p.error(u.msg||"查询天气失败")}catch(c){p.error("查询天气失败"),console.error("查询天气失败:",c)}finally{f.value=!1}};return q(()=>{N()}),(c,l)=>{const u=i("el-icon"),b=i("el-option"),C=i("el-select"),m=i("el-form-item"),D=i("el-button"),E=i("el-form"),P=i("el-skeleton"),T=i("el-empty");return o(),r("div",F,[e("div",H,[e("div",L,[n(u,null,{default:d(()=>[n(M($))]),_:1}),l[2]||(l[2]=e("span",null,"天气查询",-1))]),e("div",Q,[n(E,{inline:!0,class:"city-select-form"},{default:d(()=>[n(m,{label:"省份"},{default:d(()=>[n(C,{modelValue:h.value,"onUpdate:modelValue":l[0]||(l[0]=t=>h.value=t),placeholder:"请选择省份",onChange:I,class:"select-item","value-key":"id"},{default:d(()=>[(o(!0),r(w,null,k(g.value,t=>(o(),x(b,{key:t.id,label:t.name,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(m,{label:"城市"},{default:d(()=>[n(C,{modelValue:_.value,"onUpdate:modelValue":l[1]||(l[1]=t=>_.value=t),placeholder:"请选择城市",class:"select-item",disabled:!h.value,"value-key":"id"},{default:d(()=>[(o(!0),r(w,null,k(y.value,t=>(o(),x(b,{key:t.id,label:t.name,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),n(m,null,{default:d(()=>[n(D,{type:"primary",onClick:j,disabled:!_.value},{default:d(()=>[...l[3]||(l[3]=[z("查询天气",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1}),f.value?(o(),r("div",R,[n(P,{rows:6,animated:""})])):s.value&&s.value.data&&s.value.data[0]?(o(),r("div",S,[e("div",G,[e("div",J,[e("h2",null,a(s.value.data[0].city)+" 天气",1),e("div",K,"更新时间："+a(s.value.data[0].time),1),s.value.data[0].yesterday?(o(),r("div",O,[e("div",X,a(s.value.data[0].yesterday.type),1),e("div",Y,a(s.value.data[0].yesterday.high)+" / "+a(s.value.data[0].yesterday.low),1),e("div",Z,[e("div",null,"风向："+a(s.value.data[0].yesterday.fx)+" "+a(s.value.data[0].yesterday.fl),1),e("div",null,"空气质量："+a(s.value.data[0].yesterday.aqi),1),e("div",null,a(s.value.data[0].yesterday.notice),1)])])):V("",!0)])]),e("div",ee,[l[4]||(l[4]=e("div",{class:"forecast-header"},[e("span",null,"未来15天天气预报")],-1)),s.value.data[0].weather?(o(),r("div",te,[(o(!0),r(w,null,k(s.value.data[0].weather,(t,U)=>(o(),r("div",{class:"forecast-item",key:U},[e("div",ae,a(t.ymd),1),e("div",se,a(t.week),1),e("div",le,a(t.type),1),e("div",oe,a(t.low)+" / "+a(t.high),1),e("div",ne,[e("div",null,a(t.fx)+" "+a(t.fl),1),e("div",null,"AQI: "+a(t.aqi),1)]),e("div",re,a(t.notice),1)]))),128))])):V("",!0)])])):(o(),r("div",ce,[n(T,{description:"请选择城市查询天气"})]))])])])}}}),ve=A(de,[["__scopeId","data-v-93dd2113"]]);export{ve as default};
