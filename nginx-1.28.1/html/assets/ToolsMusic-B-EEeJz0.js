import{d as ee,S as te,c,a as t,b as a,w as r,T as se,D as u,C as ae,h as i,r as d,o,e as ne,U as le,g as oe,H as N,I as z,z as ce,V as F}from"./index-CuCVz4vD.js";import{s as R}from"./request-BYh0DQqL.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-B9ygI19o.js";const L="e6748b1e2aba0ac10737b216b3960c71",re=(v,g=15)=>R.get("/music/api.php",{params:{api:"10",key:L,search:v,type:"so",num:g}}),ue=v=>R.get("/music/api.php",{params:{api:"10",key:L,search:v,type:"song"}}),de=v=>R.get("/music/api.php",{params:{api:"10",key:L,search:v,type:"mv"}}),ve=v=>R.get("/music/api.php",{params:{api:"10",key:L,search:v,type:"lrc"}}),_e=v=>R.get("/music/api.php",{params:{api:"10",key:L,search:v,type:"comment"}}),me={class:"music-container"},pe={class:"search-section"},he={class:"main-content"},ye={class:"left-panel"},fe={key:0,class:"loading-container"},ge={key:1,class:"search-results"},ke={class:"song-info"},be={class:"song-name"},Te={class:"song-artist"},Se={class:"song-time"},Ce={key:2,class:"no-results"},Ve={class:"right-panel"},we={key:0,class:"player-section"},Ie={class:"current-song-info"},xe={class:"song-details"},Me={class:"album"},Re={class:"audio-player"},Le=["src"],Ae={class:"tab-section"},Ee={class:"lyric-section"},Ue={key:0},He=["data-time"],Be={key:1,class:"no-content"},Ne={class:"mv-section"},ze={key:0},Ke=["src"],$e={key:1,class:"no-content"},De={class:"comment-section"},Pe={key:0},qe={class:"comment-list"},Fe={class:"comment-avatar-container"},Ye={class:"comment-content"},je={class:"comment-header"},Ge={class:"comment-name"},Je={class:"comment-time"},Oe={class:"comment-text"},Qe={key:1,class:"no-content"},We={key:1,class:"no-selection"},Xe=ee({__name:"ToolsMusic",setup(v){const g=i(""),k=i([]),V=i("0"),U=i(!1),K=i(!1),h=i(null),w=i(""),b=i(null),$=i(0),Y=i(0),_=i([]),y=i(0),A=i(null),f=i(""),T=i([]),D=i("lyric"),P=i("500px"),q=async()=>{if(g.value.trim()){U.value=!0,K.value=!0;try{const l=await re(g.value);l.code===0?l.data&&l.data.length>0?(k.value=l.data[0]?.list||[],V.value=l.data[0]?.total||"0"):(k.value=[],V.value="0"):(k.value=[],V.value="0")}catch{k.value=[],V.value="0"}finally{U.value=!1}}},j=async l=>{h.value=l,f.value="",T.value=[];try{const e=await ue(l.id);if(e.code===0&&e.data&&Array.isArray(e.data)&&e.data.length>0){const s=e.data[0];s&&typeof s.url=="string"?(w.value=s.url,b.value?.play().catch(()=>{})):w.value=""}else w.value=""}catch{w.value=""}try{const e=await ve(l.id);e.code===0&&e.data&&Array.isArray(e.data)?(_.value=e.data.filter(s=>s&&typeof s.lineLyric=="string"&&typeof s.time=="string"),y.value=0):_.value=[]}catch{_.value=[]}try{const e=await de(l.id);if(e.code===0&&e.data&&Array.isArray(e.data)&&e.data.length>0){const s=e.data[0];s&&typeof s.url=="string"?f.value=s.url:f.value=""}else f.value=""}catch{f.value=""}try{const e=await _e(l.id);e.code===0&&e.data?T.value=e.data.filter(s=>s!=null):T.value=[]}catch{T.value=[]}},G=l=>{const e=parseInt(l),s=Math.floor(e/60),m=e%60;return`${s.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}`},J=()=>{b.value&&($.value=b.value.currentTime,W())},O=()=>{b.value&&(Y.value=b.value.duration)},Q=()=>{y.value=0},W=()=>{if(_.value.length===0)return;const l=$.value*1e3;let e=0;for(let s=0;s<_.value.length;s++){const m=_.value[s];if(m&&typeof m.time=="string"){const p=m.time.split(":");if(p.length===2&&typeof p[0]=="string"&&typeof p[1]=="string"){const I=parseInt(p[0],10)||0,S=p[1].split("."),H=S[0]&&parseInt(S[0],10)||0,x=S[1]&&parseInt(S[1],10)||0;if(I*60*1e3+H*1e3+x<=l)e=s;else break}}}e!==y.value&&(y.value=e,X())},X=()=>{if(!A.value)return;const e=A.value.querySelectorAll(".lyric-item")[y.value];if(e){const s=A.value.parentElement,m=s.clientHeight,E=e.offsetTop,p=e.clientHeight;s.scrollTop=E-m/2+p/2}};return te(_,()=>{y.value=0}),(l,e)=>{const s=d("el-icon"),m=d("el-button"),E=d("el-input"),p=d("el-skeleton"),I=d("el-image"),S=d("el-list-item"),H=d("el-list"),x=d("el-scrollbar"),C=d("el-empty"),B=d("el-tab-pane"),Z=d("el-tabs");return o(),c("div",me,[t("div",pe,[a(E,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=n=>g.value=n),placeholder:"请输入歌曲名、歌手名或专辑名",clearable:"",onKeyup:se(q,["enter"]),class:"search-input"},{append:r(()=>[a(m,{type:"primary",onClick:q},{default:r(()=>[a(s,null,{default:r(()=>[a(ne(le))]),_:1}),e[2]||(e[2]=oe("搜索 ",-1))]),_:1})]),_:1},8,["modelValue"])]),t("div",he,[t("div",ye,[U.value?(o(),c("div",fe,[a(p,{rows:10,animated:""})])):k.value.length>0?(o(),c("div",ge,[t("h3",null,"搜索结果 ("+u(V.value)+")",1),a(x,{height:"600px"},{default:r(()=>[a(H,null,{default:r(()=>[(o(!0),c(N,null,z(k.value,n=>(o(),ce(S,{key:n.id,class:F(["song-item",{active:h.value?.id===n.id}]),onClick:M=>j(n)},{avatar:r(()=>[a(I,{src:n.pic,fit:"cover",class:"song-cover",lazy:""},null,8,["src"])]),extra:r(()=>[t("span",Se,u(G(n.time)),1)]),default:r(()=>[t("div",ke,[t("div",be,u(n.name),1),t("div",Te,u(n.artist)+" - "+u(n.album),1)])]),_:2},1032,["onClick","class"]))),128))]),_:1})]),_:1})])):K.value?(o(),c("div",Ce,[a(C,{description:"未找到相关歌曲"})])):ae("",!0)]),t("div",Ve,[h.value?(o(),c("div",we,[t("div",Ie,[a(I,{src:h.value.pic1120||h.value.pic,fit:"cover",class:"current-song-cover"},null,8,["src"]),t("div",xe,[t("h2",null,u(h.value.name),1),t("p",null,u(h.value.artist),1),t("p",Me,u(h.value.album),1)])]),t("div",Re,[t("audio",{ref_key:"audioRef",ref:b,src:w.value,controls:"",onTimeupdate:J,onLoadedmetadata:O,onEnded:Q},null,40,Le)]),t("div",Ae,[a(Z,{modelValue:D.value,"onUpdate:modelValue":e[1]||(e[1]=n=>D.value=n),type:"card",class:"custom-tabs"},{default:r(()=>[a(B,{label:"歌词",name:"lyric",class:"tab-pane"},{default:r(()=>[t("div",Ee,[_.value.length>0?(o(),c("div",Ue,[a(x,{height:P.value,class:"lyric-scrollbar"},{default:r(()=>[t("div",{ref_key:"lyricRef",ref:A,class:"lyric-container"},[(o(!0),c(N,null,z(_.value,(n,M)=>(o(),c("div",{key:M,class:F(["lyric-item",{active:y.value===M}]),"data-time":n.time},u(n.lineLyric),11,He))),128))],512)]),_:1},8,["height"])])):(o(),c("div",Be,[a(C,{description:"暂无歌词"})]))])]),_:1}),a(B,{label:"MV",name:"mv",class:"tab-pane"},{default:r(()=>[t("div",Ne,[f.value?(o(),c("div",ze,[t("video",{src:f.value,controls:"",class:"mv-player"},null,8,Ke)])):(o(),c("div",$e,[a(C,{description:"暂无MV"})]))])]),_:1}),a(B,{label:"评论",name:"comment",class:"tab-pane"},{default:r(()=>[t("div",De,[T.value.length>0?(o(),c("div",Pe,[a(x,{height:P.value},{default:r(()=>[t("div",qe,[(o(!0),c(N,null,z(T.value,(n,M)=>(o(),c("div",{key:M,class:"comment-item"},[t("div",Fe,[a(I,{src:n.pic,fit:"cover",class:"comment-avatar"},null,8,["src"])]),t("div",Ye,[t("div",je,[t("span",Ge,u(n.name),1),t("span",Je,u(n.time),1)]),t("div",Oe,u(n.msg),1)])]))),128))])]),_:1},8,["height"])])):(o(),c("div",Qe,[a(C,{description:"暂无评论"})]))])]),_:1})]),_:1},8,["modelValue"])])])):(o(),c("div",We,[a(C,{description:"请选择一首歌曲播放"})]))])])])}}}),at=ie(Xe,[["__scopeId","data-v-1a4c0500"]]);export{at as default};
