# 登录注册功能实现计划

## 后端实现

### 1. 创建项目结构
```
backend/src/main/java/com/jinspace/
├── config/
│   └── CorsConfig.java           # 跨域配置
├── entity/
│   └── User.java                 # 用户实体类
├── mapper/
│   └── UserMapper.java           # Mapper接口
├── service/
│   ├── UserService.java          # 服务接口
│   └── impl/
│       └── UserServiceImpl.java  # 服务实现类
├── controller/
│   └── AuthController.java       # 登录注册控制器
└── BackendApplication.java       # 主应用类
```

### 2. 实现实体类（User.java）
- 对应user表字段
- 使用Lombok简化代码
- 包含getter/setter/toString

### 3. 实现Mapper接口（UserMapper.java）
- 继承BaseMapper<User>
- 添加根据用户名查询方法
- 添加根据邮箱查询方法

### 4. 实现服务层
- **UserService.java**：定义register和login方法
- **UserServiceImpl.java**：
  - 注册：检查用户名/邮箱是否存在，MD5加密密码，插入用户
  - 登录：根据用户名/邮箱查询，验证密码，更新登录时间
  - 使用Hutool的SecureUtil.md5()进行密码加密

### 5. 实现控制器（AuthController.java）
- POST /api/auth/register - 注册接口
- POST /api/auth/login - 登录接口
- 返回JSON格式结果

### 6. 跨域配置（CorsConfig.java）
- 允许前端访问
- 支持凭证

## 前端实现

### 1. 创建页面组件
- **LoginView.vue**：登录页（用户名/邮箱、密码输入）
- **RegisterView.vue**：注册页（用户名、密码、昵称、邮箱输入）

### 2. API服务
- 创建api/auth.ts，封装登录注册请求
- 使用axios发送HTTP请求

### 3. 路由配置
- 更新router/index.ts
- 添加登录和注册路由
- 配置路由守卫：未登录访问主页重定向到登录页

### 4. 路由结构
```
/			- 登录页（默认）
/register	- 注册页
/home		- 主页（需登录）
```

## 实现流程

### 1. 后端开发（按顺序）
- 创建目录结构
- 实现User实体类
- 实现UserMapper
- 实现UserService
- 实现AuthController
- 配置跨域

### 2. 前端开发（按顺序）
- 创建LoginView.vue
- 创建RegisterView.vue
- 实现API服务
- 更新路由配置和守卫
- 测试登录注册流程

## 技术要点

### 密码加密
```java
// 注册时加密密码
String encryptedPassword = SecureUtil.md5(password);
user.setPassword(encryptedPassword);

// 登录时验证密码
String encryptedPassword = SecureUtil.md5(inputPassword);
if (user.getPassword().equals(encryptedPassword)) {
    // 登录成功
}
```

### 登录成功处理
- 简单方案：返回用户信息，前端存储到localStorage
- 完整方案：生成token，前端存储并在请求中携带

### 路由守卫逻辑
```typescript
// 全局前置守卫
router.beforeEach((to, from, next) => {
  const user = localStorage.getItem('user');
  if (to.path === '/login' || to.path === '/register') {
    next();
  } else {
    user ? next() : next('/login');
  }
});
```

## 测试流程

1. 启动后端服务
2. 启动前端服务
3. 访问http://localhost:5273/，自动跳转到登录页
4. 点击"注册"链接，进入注册页
5. 填写注册信息，提交注册
6. 返回登录页，使用新注册的账号登录
7. 登录成功后跳转到主页
8. 测试未登录访问主页，是否自动跳转到登录页

## 预期结果

- ✅ 网站默认显示登录页
- ✅ 用户可以注册新账号
- ✅ 用户可以使用账号登录
- ✅ 登录成功后跳转到主页
- ✅ 未登录无法访问主页
- ✅ 密码使用MD5加密存储